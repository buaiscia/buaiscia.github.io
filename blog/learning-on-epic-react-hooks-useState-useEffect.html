<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');if(!e)return localStorage.setItem('theme','light'),d.add('light');if("system"===e){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else d.add(e)}catch(e){}}()</script><meta content="width=device-width, initial-scale=1" name="viewport"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="https://twitter.com/AlexBuaiscia"/><meta name="twitter:creator" content="https://twitter.com/AlexBuaiscia"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="600"/><meta property="og:locale" content="en-us"/><meta name="author" content="Alex Buaiscia"/><title>Epic React. Hooks. UseState, useEffect. What I&#x27;m learning. – Alex Buaiscia Blog</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="A guide of what I&#x27;m learning on the Epic React workshops by Kent Dodds. This is the second one: useState + useEffect"/><meta property="og:url" content="https://buaiscia.github.io/blog/learning-on-epic-react-hooks-useState-useEffect"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2021-11-01T00:00:00.000Z"/><meta property="article:modified_time" content="2021-11-01T00:00:00.000Z"/><meta property="article:author" content="https://buaiscia.github.io/about"/><meta property="article:tag" content="react"/><meta property="article:tag" content="web development"/><meta property="article:tag" content="epic react"/><meta property="og:title" content="Epic React. Hooks. UseState, useEffect. What I&#x27;m learning."/><meta property="og:description" content="A guide of what I&#x27;m learning on the Epic React workshops by Kent Dodds. This is the second one: useState + useEffect"/><meta property="og:image" content="https://buaiscia.github.io/static/images/twitter-card.png"/><meta property="og:image:alt" content="Epic React. Hooks. UseState, useEffect. What I&#x27;m learning."/><link rel="canonical" href="https://buaiscia.github.io/blog/learning-on-epic-react-hooks-useState-useEffect"/><meta name="twitter:image" content="https://buaiscia.github.io/static/images/twitter-card.png"/><script type="application/ld+json">{
    "@context": "https://schema.org",
    "@type": "Article",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https://buaiscia.github.io/blog/learning-on-epic-react-hooks-useState-useEffect"
    },
    "headline": "Epic React. Hooks. UseState, useEffect. What I'm learning.",
    "image": [
      "[object Object]"
     ],
    "datePublished": "2021-11-01T00:00:00.000Z",
    "dateModified": "2021-11-01T00:00:00.000Z",
    "author": {"@type": "Person","name": "Alex Buaiscia"},
    "publisher": {
      "@type": "Organization",
      "name": "Alex Buaiscia",
      "logo": {
        "@type": "ImageObject",
        "url": "undefined"
      }
    },
    "description": "A guide of what I'm learning on the Epic React workshops by Kent Dodds. This is the second one: useState + useEffect"
  }</script><meta name="next-head-count" content="29"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-HE9Y53FXBM"></script><script async="">window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments);}
              gtag('js', new Date());
              gtag('config', 'G-HE9Y53FXBM');</script><link rel="apple-touch-icon" sizes="180x180" href="/static/favicons/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png"/><link rel="manifest" href="/static/favicons/site.webmanifest"/><link rel="mask-icon" href="/static/favicons/safari-pinned-tab.svg" color="#5bbad5"/><meta name="msapplication-TileColor" content="#da532c"/><meta name="theme-color" content="#ffffff"/><link rel="alternate" type="application/rss+xml" href="/index.xml"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><link rel="stylesheet" media="print" data-href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&amp;display=swap"/><noscript><link rel="stylesheet" data-href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&amp;display=swap"/></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><link rel="preload" href="/_next/static/css/955c566e433c371d.css" as="style"/><link rel="stylesheet" href="/_next/static/css/955c566e433c371d.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/main-0323a0badb743639.js" defer=""></script><script src="/_next/static/chunks/pages/_app-ce08a17408523e45.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-a8b7d2c6dc7a6ebc.js" defer=""></script><script src="/_next/static/JrHN6SXNT5iiCuUtPfJ0y/_buildManifest.js" defer=""></script><script src="/_next/static/JrHN6SXNT5iiCuUtPfJ0y/_ssgManifest.js" defer=""></script><script src="/_next/static/JrHN6SXNT5iiCuUtPfJ0y/_middlewareManifest.js" defer=""></script><style data-href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap">@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v8/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuLyfMZs.woff) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v8/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuGKYMZs.woff) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v8/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuFuYMZs.woff) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v8/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v8/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v8/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v8/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v8/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v8/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v8/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v8/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v8/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v8/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v8/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v8/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v8/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v8/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v8/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v8/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v8/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v8/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v8/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v8/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v8/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body class="antialiased text-black bg-white dark:bg-gray-900 dark:text-white"><div id="__next" data-reactroot=""><div class="max-w-3xl px-4 mx-auto sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex flex-col justify-between h-screen"><header class="flex items-center justify-between py-10"><div><a aria-label="Alex Buaiscia Tech Blog" href="/"><div class="flex items-center justify-between"><div class="mr-3"><svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="-3 -2.75 6.5 6"><path class="logo_svg__path" fill="none" stroke="#0EA5E9" stroke-width="0.1" stroke-miterlimit="10" d="M0 0c.043 0 .082-.035.088-.088C.095-.145.064-.209 0-.25a.29.29 0 00-.265-.015A.42.42 0 00-.5 0a.547.547 0 00.058.442c.091.153.25.267.442.308A.8.8 0 00.619.619C.819.48.959.258 1 0a1.05 1.05 0 00-.205-.795A1.171 1.171 0 000-1.25a1.305 1.305 0 00-.972.278A1.428 1.428 0 00-1.5 0c-.043.406.081.821.351 1.149.28.341.693.56 1.149.601a1.81 1.81 0 001.326-.424C1.713.999 1.958.522 2 0a2.06 2.06 0 00-.497-1.503A2.186 2.186 0 000-2.25a2.302 2.302 0 00-1.679.571A2.43 2.43 0 00-2.5 0c-.043.671.187 1.34.644 1.856A2.686 2.686 0 000 2.75a2.807 2.807 0 002.033-.717A2.934 2.934 0 003 0"></path></svg></div><div class="hidden h-6 text-2xl font-semibold sm:block">Alex Buaiscia Tech Blog</div></div></a></div><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/blog">Blog</a><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/tags">Tags</a><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/about">Who&#x27;s me</a></div><button aria-label="Toggle Dark Mode" type="button" class="w-8 h-8 p-1 ml-1 mr-1 rounded sm:ml-4"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg></button><div class="sm:hidden"><button type="button" class="w-8 h-8 ml-1 mr-1 rounded" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed w-full h-full top-24 right-0 bg-gray-200 dark:bg-gray-800 opacity-95 z-10 transform ease-in-out duration-300 translate-x-full"><button type="button" aria-label="toggle modal" class="fixed w-full h-full cursor-auto focus:outline-none"></button><nav class="fixed h-full mt-8"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/blog">Blog</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags">Tags</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/about">Who&#x27;s me</a></div></nav></div></div></div></header><main class="mb-auto"><div class="max-w-3xl px-4 mx-auto sm:px-6 xl:max-w-5xl xl:px-0"><article class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700"><header class="pt-6 xl:pb-6"><div class="space-y-1 text-center"><dl class="space-y-10"><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2021-11-01">Monday, November 1, 2021</time></dd></div></dl><div><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">Epic React. Hooks. UseState, useEffect. What I&#x27;m learning.</h1></div></div></header><div class="pb-8 divide-y divide-gray-200 xl:divide-y-0 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6" style="grid-template-rows:auto 1fr"><dl class="pt-6 pb-10 xl:pt-11 xl:border-b xl:border-gray-200 xl:dark:border-gray-700"><dt class="sr-only">Authors</dt><dd><ul class="flex justify-center space-x-8 xl:block sm:space-x-12 xl:space-x-0 xl:space-y-8"><li class="flex items-center space-x-2"><img src="https://res.cloudinary.com/buaiscia/image/upload/v1614031509/techblog/avatar_rlujgi.jpg" alt="avatar" class="w-10 h-10 rounded-full"/><dl class="text-sm font-medium leading-5 whitespace-nowrap"><dt class="sr-only">Name</dt><dd class="text-gray-900 dark:text-gray-100">Alex Buaiscia</dd><dt class="sr-only">Twitter</dt><dd><a target="_blank" rel="noopener noreferrer" href="https://twitter.com/AlexBuaiscia" class="text-blue-500 hover:text-blue-600 dark:hover:text-blue-400">@AlexBuaiscia</a></dd></dl></li></ul></dd></dl><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:pb-0 xl:col-span-3 xl:row-span-2"><div class="pt-10 pb-8 prose dark:prose-dark max-w-none"><div><h2 id="back-into-react"><a href="#back-into-react" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Back into React</h2><p>After a long break and quite more experience, I managed to get back to EpicReact. This is the second chapter of the series. Here&#x27;s the link to the first one:</p><p><a target="_blank" rel="noopener noreferrer" href="https://buaiscia.github.io/blog/learning-on-epic-react-fundamentals">Epic React. Fundamentals. What I&#x27;m learning.</a></p><p>As in the other post, this isn&#x27;t a guide to React nor to EpicReact. They are just my notes, thoughts and learning on the course workshops. Few things can appear as confusing for lack of context. However, I hope you can find some interesting points to reflect upon. Repositories and solutions are anyway publicly available on Kent&#x27;s Github.</p><p>Let&#x27;s dive into hooks, with a focus on useState and useEffect!</p><h2 id="1---usestate"><a href="#1---usestate" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>1 - useState</h2><p>A first good point is: in controlled components value is changed/updated by the state and uncontrolled by event handlers.</p><p>The interesting part of useState is how under the hood is nothing else but an array declaration. When it&#x27;s used, it gets two elements of the array, in which the first is the variable and the second one is the function to update the variable.</p><p>So a code like this:
<code>const [ count, setCount ] = useState(0)</code>
would be, not destructured:</p><pre class="language-javascript"><code class="language-javascript"><span class="text-code-purple">const</span> array <span class="">=</span> <span class="text-code-blue">useState</span><span class="text-code-white">(</span><span class="">0</span><span class="text-code-white">)</span>
<span class="text-code-purple">const</span> count <span class="">=</span> array<span class="text-code-white">[</span><span class="">0</span><span class="text-code-white">]</span>
<span class="text-code-purple">const</span> setCount <span class="">=</span> array<span class="text-code-white">[</span><span class="">1</span><span class="text-code-white">]</span>
</code></pre><p>The first exercise is quite simple if one understands React states well. Every time (unless different specified) the state changes, in any part of the component, there will be a re-render of the component virtual DOM, updating what appears on the page.
If I call a function on the onChange in the input, and that function changes the state (<code>setCount(event.target.value)</code>), then I can call the updated state in any part of the render
<code> {count ? &lt;strong&gt;Count is {count}&lt;/strong&gt; : &#x27;Add a number to count&#x27;}</code></p><p>In the second part the task would be to use a prop in the component as initial value to pass
<code>&lt;Counting initialCount={0}</code>
I find there are different ways. The best way is to setState to that initial value that is destructured in the function arguments:</p><pre class="language-javascript"><code class="language-javascript"><span class="text-code-purple">function</span> <span class="text-code-blue"><span class="">Counting</span></span><span class="text-code-white">(</span><span class=""><span class="text-code-white">{</span> initialCount <span class="">=</span> <span class="">0</span> <span class="text-code-white">}</span></span><span class="text-code-white">)</span>
</code></pre><p>Destructuring is necessary because initialCount is an object so, if we&#x27;re passing the argument just like it (initialCount), the result will be <!-- -->[Object object]<!-- -->.
The default value (= &#x27;&#x27;) is also necessary in case we don&#x27;t pass anything as a prop. In this case we don&#x27;t cause a crash because of undefined value (unless we use Typescript and we define it as possible undefined).
So one way is to setState(initialCount) and value=count in the input.</p><p>Another possible way is to set the defaultValue of the input to the initialCount. This will have the same effect except that the state of the rendered text won&#x27;t be updated until something is typed. It&#x27;s possible to create a check to use the count (like a nested if but with ternary operator). However, it will make the code more difficult to read and follow in its flow.</p><h2 id="2---useeffect"><a href="#2---useeffect" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>2 - useEffect</h2><p>This hook is called at every render of the component whenever its dependencies change. Or at any render if the dependency array is empty.</p><p>We can persist the state: call the localstorage methods inside useEffect (getter and/or setter) <code>const [name, setName] = React.useState(window.localStorage.getItem(&#x27;name&#x27;) || initialName)</code>
However in doing so we can run into a performance issue. Access to localstorage is slower than other methods.</p><p>There are some workarounds for this:</p><ul><li>React’s useState hook allows you to pass a function instead of the actual value, and then it will only call that function to get the state value when the component is rendered the first time: <code>React.useState(() =&gt; someExpensiveComputation())</code> ... that&#x27;s the same as the callback on setState in class components
<code>const [name, setName] = React.useState(() =&gt; window.localStorage.getItem(&#x27;name&#x27;) || initialName)</code>
If we put a console inside the callback we cans see it&#x27;s called only on the first render.
It should be used only for bottleneck functions that require sync time</li></ul><p>Or using useEffect: </p><ul><li>lazy initialization, or not reading from localStorage at every render.</li><li>dependency array: second argument on useEffect which signals to React that your effect callback function should be called when (and only when) those dependencies change:</li></ul><pre class="language-javascript"><code class="language-javascript"><span class="">React</span><span class="text-code-white">.</span><span class="">useEffect</span><span class="text-code-white">(</span><span class="text-code-white">(</span><span class="text-code-white">)</span> <span class="">=&gt;</span> <span class="text-code-white">{</span>
    <span class="">window</span><span class="text-code-white">.</span><span class="">localStorage</span><span class="text-code-white">.</span><span class="">setItem</span><span class="text-code-white">(</span><span class="text-code-green">&#x27;count&#x27;</span><span class="text-code-white">,</span> count<span class="text-code-white">)</span>
  <span class="text-code-white">}</span><span class="text-code-white">,</span> <span class="text-code-white">[</span>name<span class="text-code-white">]</span><span class="text-code-white">)</span>
</code></pre><p>If other states apart from name change setItem won&#x27;t be called
If left empty, it&#x27;ll be called only at the first render.
The state in the dependency array is an object that is compared on the render with the previous state through object comparison. If they&#x27;re the same useEffect won&#x27;t run , otherwise yes.</p><p>Custom hooks. They are external functions called inside a method. Their names start with ”use”.
If we have different functions inside the component method we can externalize those, even useEffect:</p><p>If we have a method like this:</p><pre class="language-javascript"><code class="language-javascript"><span class="text-code-purple">function</span> <span class="text-code-blue"><span class="">Greeting</span></span><span class="text-code-white">(</span><span class=""><span class="text-code-white">{</span> initialCount <span class="">=</span> <span class="">0</span> <span class="text-code-white">}</span></span><span class="text-code-white">)</span> <span class="text-code-white">{</span>
  <span class="text-code-purple">const</span> <span class="text-code-white">[</span>count<span class="text-code-white">,</span> setCount<span class="text-code-white">]</span> <span class="">=</span> <span class="">React</span><span class="text-code-white">.</span><span class="">useState</span><span class="text-code-white">(</span>
    <span class="text-code-white">(</span><span class="text-code-white">)</span> <span class="">=&gt;</span> <span class="">window</span><span class="text-code-white">.</span><span class="">localStorage</span><span class="text-code-white">.</span><span class="">getItem</span><span class="text-code-white">(</span><span class="text-code-green">&#x27;count&#x27;</span><span class="text-code-white">)</span> <span class="">||</span> initialCount<span class="text-code-white">,</span>
  <span class="text-code-white">)</span>

  <span class="">React</span><span class="text-code-white">.</span><span class="">useEffect</span><span class="text-code-white">(</span><span class="text-code-white">(</span><span class="text-code-white">)</span> <span class="">=&gt;</span> <span class="text-code-white">{</span>
    <span class="">window</span><span class="text-code-white">.</span><span class="">localStorage</span><span class="text-code-white">.</span><span class="">setItem</span><span class="text-code-white">(</span><span class="text-code-green">&#x27;count&#x27;</span><span class="text-code-white">,</span> count<span class="text-code-white">)</span>
  <span class="text-code-white">}</span><span class="text-code-white">,</span> <span class="text-code-white">[</span>count<span class="text-code-white">]</span><span class="text-code-white">)</span>

  <span class="text-code-purple">function</span> <span class="text-code-blue">handleChange</span><span class="text-code-white">(</span><span class="">event</span><span class="text-code-white">)</span> <span class="text-code-white">{</span>
    <span class="text-code-blue">setCount</span><span class="text-code-white">(</span>event<span class="text-code-white">.</span><span class="">target</span><span class="text-code-white">.</span><span class="">value</span><span class="text-code-white">)</span>
  <span class="text-code-white">}</span>
</code></pre><p>We can convert it to this and then use it in the main method as custom hook:</p><pre class="language-javascript"><code class="language-javascript"><span class="text-code-purple">function</span> <span class="text-code-blue">useLocalStorageWithState</span><span class="text-code-white">(</span><span class="text-code-white">)</span> <span class="text-code-white">{</span>
  <span class="text-code-purple">const</span> <span class="text-code-white">[</span>count<span class="text-code-white">,</span> setCount<span class="text-code-white">]</span> <span class="">=</span> <span class="">React</span><span class="text-code-white">.</span><span class="">useState</span><span class="text-code-white">(</span>
    <span class="text-code-white">(</span><span class="text-code-white">)</span> <span class="">=&gt;</span> <span class="">window</span><span class="text-code-white">.</span><span class="">localStorage</span><span class="text-code-white">.</span><span class="">getItem</span><span class="text-code-white">(</span><span class="text-code-green">&#x27;count&#x27;</span><span class="text-code-white">)</span> <span class="">||</span> initialCount<span class="text-code-white">,</span>
  <span class="text-code-white">)</span>

  <span class="">React</span><span class="text-code-white">.</span><span class="">useEffect</span><span class="text-code-white">(</span><span class="text-code-white">(</span><span class="text-code-white">)</span> <span class="">=&gt;</span> <span class="text-code-white">{</span>
    <span class="">window</span><span class="text-code-white">.</span><span class="">localStorage</span><span class="text-code-white">.</span><span class="">setItem</span><span class="text-code-white">(</span><span class="text-code-green">&#x27;count&#x27;</span><span class="text-code-white">,</span> count<span class="text-code-white">)</span>
  <span class="text-code-white">}</span><span class="text-code-white">,</span> <span class="text-code-white">[</span>count<span class="text-code-white">]</span><span class="text-code-white">)</span>

  <span class="text-code-purple">return</span> <span class="text-code-white">[</span>count<span class="text-code-white">,</span> setCount<span class="text-code-white">]</span><span class="text-code-white">;</span>
<span class="text-code-white">}</span>

<span class="text-code-purple">function</span> <span class="text-code-blue"><span class="">Greeting</span></span><span class="text-code-white">(</span><span class=""><span class="text-code-white">{</span> initialCount<span class="">=</span> <span class="">0</span> <span class="text-code-white">}</span></span><span class="text-code-white">)</span> <span class="text-code-white">{</span>
  <span class="text-code-purple">const</span> <span class="text-code-white">[</span>count<span class="text-code-white">,</span> setCount<span class="text-code-white">]</span> <span class="">=</span> <span class="text-code-blue">useLocalStorageWithState</span><span class="text-code-white">(</span><span class="text-code-white">)</span>
  <span class="text-code-purple">function</span> <span class="text-code-blue">handleChange</span><span class="text-code-white">(</span><span class="">event</span><span class="text-code-white">)</span> <span class="text-code-white">{</span>
    <span class="text-code-blue">setCount</span><span class="text-code-white">(</span>event<span class="text-code-white">.</span><span class="">target</span><span class="text-code-white">.</span><span class="">value</span><span class="text-code-white">)</span>
  <span class="text-code-white">}</span>
</code></pre><h4 id="other-notes"><a href="#other-notes" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Other notes</h4><ul><li><p>Setting up a callback inside useState makes the setting of the state as lazy, as it compares the states and doesn&#x27;t change it if it&#x27;s the same.</p></li><li><p>If you ar getting an error that goes like: &#x27;React Hook ... is called in function ... which is neither a React function component or custom React Hook function&#x27;, then it&#x27;s possible that you put a wrong name to the custom hook.
As a React convention, your function should start with &#x27;use&#x27; and probably is not. For example, useGetItems.
So, instead of syncLocalStorageWithState, we call it useLocalStorageWithState.</p></li></ul><p>useLocalStorageWithState should have the same use as the useState hook, so it can return an array like useState, and we can store it in a similar array. So we have created a custom useState hook that does other stuff as well.
We pass as well count and initialCount as parameters <code>useLocalStorageWithState(count, initialCount)</code> and then making useLocalStorageWithState more generic, receiving as arguments <code>key, defaultValue</code> , so the method can be reused freely and not stay chained to a count state. The same applies to the state. We can set <!-- -->[state, setState]<!-- --> and return the same.
Having two arguments means that also useEffect should have two in the dependency array.</p><p>The logic of the flexible localStorage hook is the following:</p><ul><li>get the item from local storage</li><li>if present, JSON parse it and return the result</li><li>if not, return the default value</li></ul><p>That&#x27;s for getting the state. For setting the changes using useEffect -in this case for creating/editing the local storage- se can move forward like this: once the state changes we can just stringify whatever the state will be and store it.
Serialize will be for stringify the JSON, while deserialize for parsing it.</p><p>In case as argument of useLocalStorageWithState, instead of a number, we&#x27;ll pass a function, it&#x27;s possible to create a check to return the results of another function.
<code>const [name, setName] = useLocalStorageWithState(&#x27;name&#x27;, complexCounting() )</code> --&gt; pass a function as default value
<code>return typeof defaultValue === &#x27;function&#x27; ? defaultValue() : defaultValue;</code> --&gt; return to useState the result of the method</p><p>Then it comes the complicated part.
In the above case, we are passing two parameters to useLocalStorageWithState. The first one -the key- is a string and the second a primitive value or a method.
What if somebody wants to pass another value to the &#x27;key&#x27;? Now, for example, can be passed &#x27;count&#x27; as string, but maybe somebody will want to pass something different (to store a different thing in local storage, for instance).</p><p>There&#x27;s no direct way to change the state of the key, so what could be done is storing the key into a variable that won&#x27;t trigger the render, using useRef. Following that, in useEffect we can compare the old key with the new one.</p><p>According to the docs:</p><blockquote><p>useRef returns a mutable ref object whose .current property is initialized to the passed argument (initialValue). The returned object will persist for the full lifetime of the component.
Note that useRef() is useful for more than the ref attribute. It’s handy for keeping any mutable value around similar to how you’d use instance fields in classes.</p></blockquote><p>The difference with useState is then that useRef doesn&#x27;t trigger a rerender, so with this hook we can actually set the key without triggering the rerender. The purpose of this is clear in the useEffect</p><pre class="language-javascript"><code class="language-javascript"><span class="text-code-purple">const</span> prevKey <span class="">=</span> prevKeyRef<span class="text-code-white">.</span><span class="">current</span><span class="text-code-white">;</span>
    <span class="text-code-purple">if</span> <span class="text-code-white">(</span>prevKey <span class="">!==</span> key<span class="text-code-white">)</span> <span class="text-code-white">{</span>
      <span class="">window</span><span class="text-code-white">.</span><span class="">localStorage</span><span class="text-code-white">.</span><span class="">removeItem</span><span class="text-code-white">(</span>prevKey<span class="text-code-white">)</span>
    <span class="text-code-white">}</span>
</code></pre><p>Usually we store in localStorage a value. But this value is in an object, and that object has a key. So for now it&#x27;s &#x27;count&#x27;. But if it will be &#x27;sum&#x27;, and we don&#x27;t remove the initial key, we&#x27;ll have two objects in localStorage. So if the new key and the old one, which is stored in the useRef var, is different, we will remove the object in localStorage with the old key.</p></div></div></div><footer class="text-sm font-medium leading-5 divide-gray-200 xl:divide-y dark:divide-gray-700 xl:col-start-1 xl:row-start-2"><div class="py-4 xl:py-8"><h2 class="text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400">Tags</h2><div class="space-x-3 xl:flex xl:flex-col xl:space-x-0"><a class="text-sm font-medium text-blue-500 uppercase hover:text-blue-600 dark:hover:text-blue-400" href="/tags/react">react</a><a class="text-sm font-medium text-blue-500 uppercase hover:text-blue-600 dark:hover:text-blue-400" href="/tags/web-development">web-development</a><a class="text-sm font-medium text-blue-500 uppercase hover:text-blue-600 dark:hover:text-blue-400" href="/tags/epic-react">epic-react</a></div></div><div class="flex justify-between py-4 xl:block xl:space-y-8 xl:py-8"><div><h2 class="text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400">Previous Article</h2><div class="text-blue-500 hover:text-blue-600 dark:hover:text-blue-400"><a href="/blog/what-learnt-in-first-six-months-self-taught-developer">What I learnt in my first six months as a working (self-taught) developer</a></div></div><div><h2 class="text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400">Next Article</h2><div class="text-blue-500 hover:text-blue-600 dark:hover:text-blue-400"><a href="/blog/how-passed-from-junior-to-intermediate-dev-one-year">How I passed from Junior to Intermediate developer in one year</a></div></div></div><div class="pt-4 xl:pt-8"><a class="text-blue-500 hover:text-blue-600 dark:hover:text-blue-400" href="/blog">← Back to the blog</a></div></footer></div></article></div></main><footer class="flex flex-col items-center mt-16"><div class="flex mb-3 space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/buaiscia"><span class="sr-only">github</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400 h-6 w-6"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/in/alex-buaiscia/"><span class="sr-only">linkedin</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400 h-6 w-6"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://twitter.com/AlexBuaiscia"><span class="sr-only">twitter</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current text-gray-700 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400 h-6 w-6"><path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"></path></svg></a></div><div class="flex mb-2 space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>Alex Buaiscia</div><div> • </div><div>© 2022</div><div> • </div><a href="/">Alex Buaiscia Blog</a><br/><br/><br/></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":{"compiledSource":"\"use strict\";\n\nvar _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i \u003c arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i \u003c sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) \u003e= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i \u003c sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) \u003e= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar layoutProps = {};\nvar MDXLayout = \"wrapper\";\n\nfunction MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h2\", {\n    \"id\": \"back-into-react\"\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#back-into-react\",\n    \"aria-hidden\": \"true\",\n    \"tabIndex\": -1\n  }, mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"icon icon-link\"\n  })), \"Back into React\"), mdx(\"p\", null, \"After a long break and quite more experience, I managed to get back to EpicReact. This is the second chapter of the series. Here's the link to the first one:\"), mdx(\"p\", null, mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://buaiscia.github.io/blog/learning-on-epic-react-fundamentals\"\n  }, \"Epic React. Fundamentals. What I'm learning.\")), mdx(\"p\", null, \"As in the other post, this isn't a guide to React nor to EpicReact. They are just my notes, thoughts and learning on the course workshops. Few things can appear as confusing for lack of context. However, I hope you can find some interesting points to reflect upon. Repositories and solutions are anyway publicly available on Kent's Github.\"), mdx(\"p\", null, \"Let's dive into hooks, with a focus on useState and useEffect!\"), mdx(\"h2\", {\n    \"id\": \"1---usestate\"\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#1---usestate\",\n    \"aria-hidden\": \"true\",\n    \"tabIndex\": -1\n  }, mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"icon icon-link\"\n  })), \"1 - useState\"), mdx(\"p\", null, \"A first good point is: in controlled components value is changed/updated by the state and uncontrolled by event handlers.\"), mdx(\"p\", null, \"The interesting part of useState is how under the hood is nothing else but an array declaration. When it's used, it gets two elements of the array, in which the first is the variable and the second one is the function to update the variable.\"), mdx(\"p\", null, \"So a code like this:\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"const [ count, setCount ] = useState(0)\"), \"\\nwould be, not destructured:\"), mdx(\"pre\", {\n    \"className\": \"language-javascript\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-purple\"\n  }, \"const\"), \" array \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-blue\"\n  }, \"useState\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"0\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \")\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-purple\"\n  }, \"const\"), \" count \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"=\"), \" array\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"[\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"0\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"]\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-purple\"\n  }, \"const\"), \" setCount \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"=\"), \" array\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"[\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"1\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"]\"), \"\\n\")), mdx(\"p\", null, \"The first exercise is quite simple if one understands React states well. Every time (unless different specified) the state changes, in any part of the component, there will be a re-render of the component virtual DOM, updating what appears on the page.\\nIf I call a function on the onChange in the input, and that function changes the state (\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"setCount(event.target.value)\"), \"), then I can call the updated state in any part of the render\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \" {count ? \u003cstrong\u003eCount is {count}\u003c/strong\u003e : 'Add a number to count'}\")), mdx(\"p\", null, \"In the second part the task would be to use a prop in the component as initial value to pass\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"\u003cCounting initialCount={0}\"), \"\\nI find there are different ways. The best way is to setState to that initial value that is destructured in the function arguments:\"), mdx(\"pre\", {\n    \"className\": \"language-javascript\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-purple\"\n  }, \"function\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-blue\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"\"\n  }, \"Counting\")), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"text-code-white\"\n  }, \"{\"), \" initialCount \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"\"\n  }, \"0\"), \" \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"text-code-white\"\n  }, \"}\")), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \")\"), \"\\n\")), mdx(\"p\", null, \"Destructuring is necessary because initialCount is an object so, if we're passing the argument just like it (initialCount), the result will be \", \"[Object object]\", \".\\nThe default value (= '') is also necessary in case we don't pass anything as a prop. In this case we don't cause a crash because of undefined value (unless we use Typescript and we define it as possible undefined).\\nSo one way is to setState(initialCount) and value=count in the input.\"), mdx(\"p\", null, \"Another possible way is to set the defaultValue of the input to the initialCount. This will have the same effect except that the state of the rendered text won't be updated until something is typed. It's possible to create a check to use the count (like a nested if but with ternary operator). However, it will make the code more difficult to read and follow in its flow.\"), mdx(\"h2\", {\n    \"id\": \"2---useeffect\"\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#2---useeffect\",\n    \"aria-hidden\": \"true\",\n    \"tabIndex\": -1\n  }, mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"icon icon-link\"\n  })), \"2 - useEffect\"), mdx(\"p\", null, \"This hook is called at every render of the component whenever its dependencies change. Or at any render if the dependency array is empty.\"), mdx(\"p\", null, \"We can persist the state: call the localstorage methods inside useEffect (getter and/or setter) \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"const [name, setName] = React.useState(window.localStorage.getItem('name') || initialName)\"), \"\\nHowever in doing so we can run into a performance issue. Access to localstorage is slower than other methods.\"), mdx(\"p\", null, \"There are some workarounds for this:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"React\\u2019s useState hook allows you to pass a function instead of the actual value, and then it will only call that function to get the state value when the component is rendered the first time: \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"React.useState(() =\u003e someExpensiveComputation())\"), \" ... that's the same as the callback on setState in class components\\n\", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"const [name, setName] = React.useState(() =\u003e window.localStorage.getItem('name') || initialName)\"), \"\\nIf we put a console inside the callback we cans see it's called only on the first render.\\nIt should be used only for bottleneck functions that require sync time\")), mdx(\"p\", null, \"Or using useEffect: \"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"lazy initialization, or not reading from localStorage at every render.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"dependency array: second argument on useEffect which signals to React that your effect callback function should be called when (and only when) those dependencies change:\")), mdx(\"pre\", {\n    \"className\": \"language-javascript\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"React\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"useEffect\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"=\u003e\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"{\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"window\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"localStorage\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"setItem\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-green\"\n  }, \"'count'\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \",\"), \" count\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \")\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"}\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \",\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"[\"), \"name\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"]\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \")\"), \"\\n\")), mdx(\"p\", null, \"If other states apart from name change setItem won't be called\\nIf left empty, it'll be called only at the first render.\\nThe state in the dependency array is an object that is compared on the render with the previous state through object comparison. If they're the same useEffect won't run , otherwise yes.\"), mdx(\"p\", null, \"Custom hooks. They are external functions called inside a method. Their names start with \\u201Duse\\u201D.\\nIf we have different functions inside the component method we can externalize those, even useEffect:\"), mdx(\"p\", null, \"If we have a method like this:\"), mdx(\"pre\", {\n    \"className\": \"language-javascript\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-purple\"\n  }, \"function\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-blue\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"\"\n  }, \"Greeting\")), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"text-code-white\"\n  }, \"{\"), \" initialCount \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"\"\n  }, \"0\"), \" \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"text-code-white\"\n  }, \"}\")), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"{\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-purple\"\n  }, \"const\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"[\"), \"count\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \",\"), \" setCount\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"]\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"React\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"useState\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"(\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"=\u003e\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"window\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"localStorage\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"getItem\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-green\"\n  }, \"'count'\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"||\"), \" initialCount\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \",\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \")\"), \"\\n\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"React\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"useEffect\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"=\u003e\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"{\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"window\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"localStorage\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"setItem\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-green\"\n  }, \"'count'\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \",\"), \" count\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \")\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"}\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \",\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"[\"), \"count\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"]\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \")\"), \"\\n\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-purple\"\n  }, \"function\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-blue\"\n  }, \"handleChange\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"event\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"{\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-blue\"\n  }, \"setCount\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"(\"), \"event\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"target\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"value\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \")\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"}\"), \"\\n\")), mdx(\"p\", null, \"We can convert it to this and then use it in the main method as custom hook:\"), mdx(\"pre\", {\n    \"className\": \"language-javascript\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-purple\"\n  }, \"function\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-blue\"\n  }, \"useLocalStorageWithState\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"{\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-purple\"\n  }, \"const\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"[\"), \"count\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \",\"), \" setCount\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"]\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"React\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"useState\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"(\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"=\u003e\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"window\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"localStorage\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"getItem\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-green\"\n  }, \"'count'\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"||\"), \" initialCount\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \",\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \")\"), \"\\n\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"React\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"useEffect\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"=\u003e\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"{\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"window\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"localStorage\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"setItem\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-green\"\n  }, \"'count'\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \",\"), \" count\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \")\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"}\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \",\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"[\"), \"count\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"]\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \")\"), \"\\n\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-purple\"\n  }, \"return\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"[\"), \"count\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \",\"), \" setCount\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"]\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \";\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"}\"), \"\\n\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-purple\"\n  }, \"function\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-blue\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"\"\n  }, \"Greeting\")), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"text-code-white\"\n  }, \"{\"), \" initialCount\", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"\"\n  }, \"0\"), \" \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"text-code-white\"\n  }, \"}\")), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"{\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-purple\"\n  }, \"const\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"[\"), \"count\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \",\"), \" setCount\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"]\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-blue\"\n  }, \"useLocalStorageWithState\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \")\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-purple\"\n  }, \"function\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-blue\"\n  }, \"handleChange\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"event\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"{\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-blue\"\n  }, \"setCount\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"(\"), \"event\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"target\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"value\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \")\"), \"\\n  \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"}\"), \"\\n\")), mdx(\"h4\", {\n    \"id\": \"other-notes\"\n  }, mdx(\"a\", {\n    parentName: \"h4\",\n    \"href\": \"#other-notes\",\n    \"aria-hidden\": \"true\",\n    \"tabIndex\": -1\n  }, mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"icon icon-link\"\n  })), \"Other notes\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Setting up a callback inside useState makes the setting of the state as lazy, as it compares the states and doesn't change it if it's the same.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"If you ar getting an error that goes like: 'React Hook ... is called in function ... which is neither a React function component or custom React Hook function', then it's possible that you put a wrong name to the custom hook.\\nAs a React convention, your function should start with 'use' and probably is not. For example, useGetItems.\\nSo, instead of syncLocalStorageWithState, we call it useLocalStorageWithState.\"))), mdx(\"p\", null, \"useLocalStorageWithState should have the same use as the useState hook, so it can return an array like useState, and we can store it in a similar array. So we have created a custom useState hook that does other stuff as well.\\nWe pass as well count and initialCount as parameters \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"useLocalStorageWithState(count, initialCount)\"), \" and then making useLocalStorageWithState more generic, receiving as arguments \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"key, defaultValue\"), \" , so the method can be reused freely and not stay chained to a count state. The same applies to the state. We can set \", \"[state, setState]\", \" and return the same.\\nHaving two arguments means that also useEffect should have two in the dependency array.\"), mdx(\"p\", null, \"The logic of the flexible localStorage hook is the following:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"get the item from local storage\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"if present, JSON parse it and return the result\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"if not, return the default value\")), mdx(\"p\", null, \"That's for getting the state. For setting the changes using useEffect -in this case for creating/editing the local storage- se can move forward like this: once the state changes we can just stringify whatever the state will be and store it.\\nSerialize will be for stringify the JSON, while deserialize for parsing it.\"), mdx(\"p\", null, \"In case as argument of useLocalStorageWithState, instead of a number, we'll pass a function, it's possible to create a check to return the results of another function.\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"const [name, setName] = useLocalStorageWithState('name', complexCounting() )\"), \" --\u003e pass a function as default value\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"return typeof defaultValue === 'function' ? defaultValue() : defaultValue;\"), \" --\u003e return to useState the result of the method\"), mdx(\"p\", null, \"Then it comes the complicated part.\\nIn the above case, we are passing two parameters to useLocalStorageWithState. The first one -the key- is a string and the second a primitive value or a method.\\nWhat if somebody wants to pass another value to the 'key'? Now, for example, can be passed 'count' as string, but maybe somebody will want to pass something different (to store a different thing in local storage, for instance).\"), mdx(\"p\", null, \"There's no direct way to change the state of the key, so what could be done is storing the key into a variable that won't trigger the render, using useRef. Following that, in useEffect we can compare the old key with the new one.\"), mdx(\"p\", null, \"According to the docs:\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"useRef returns a mutable ref object whose .current property is initialized to the passed argument (initialValue). The returned object will persist for the full lifetime of the component.\\nNote that useRef() is useful for more than the ref attribute. It\\u2019s handy for keeping any mutable value around similar to how you\\u2019d use instance fields in classes.\")), mdx(\"p\", null, \"The difference with useState is then that useRef doesn't trigger a rerender, so with this hook we can actually set the key without triggering the rerender. The purpose of this is clear in the useEffect\"), mdx(\"pre\", {\n    \"className\": \"language-javascript\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-purple\"\n  }, \"const\"), \" prevKey \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"=\"), \" prevKeyRef\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"current\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \";\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-purple\"\n  }, \"if\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"(\"), \"prevKey \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"!==\"), \" key\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \")\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"{\"), \"\\n      \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"window\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"localStorage\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"\"\n  }, \"removeItem\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"(\"), \"prevKey\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \")\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"text-code-white\"\n  }, \"}\"), \"\\n\")), mdx(\"p\", null, \"Usually we store in localStorage a value. But this value is in an object, and that object has a key. So for now it's 'count'. But if it will be 'sum', and we don't remove the initial key, we'll have two objects in localStorage. So if the new key and the old one, which is stored in the useRef var, is different, we will remove the object in localStorage with the old key.\"));\n}\n\n;\nMDXContent.isMDXComponent = true;","renderedOutput":"\u003ch2 id=\"back-into-react\"\u003e\u003ca href=\"#back-into-react\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eBack into React\u003c/h2\u003e\u003cp\u003eAfter a long break and quite more experience, I managed to get back to EpicReact. This is the second chapter of the series. Here\u0026#x27;s the link to the first one:\u003c/p\u003e\u003cp\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://buaiscia.github.io/blog/learning-on-epic-react-fundamentals\"\u003eEpic React. Fundamentals. What I\u0026#x27;m learning.\u003c/a\u003e\u003c/p\u003e\u003cp\u003eAs in the other post, this isn\u0026#x27;t a guide to React nor to EpicReact. They are just my notes, thoughts and learning on the course workshops. Few things can appear as confusing for lack of context. However, I hope you can find some interesting points to reflect upon. Repositories and solutions are anyway publicly available on Kent\u0026#x27;s Github.\u003c/p\u003e\u003cp\u003eLet\u0026#x27;s dive into hooks, with a focus on useState and useEffect!\u003c/p\u003e\u003ch2 id=\"1---usestate\"\u003e\u003ca href=\"#1---usestate\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003e1 - useState\u003c/h2\u003e\u003cp\u003eA first good point is: in controlled components value is changed/updated by the state and uncontrolled by event handlers.\u003c/p\u003e\u003cp\u003eThe interesting part of useState is how under the hood is nothing else but an array declaration. When it\u0026#x27;s used, it gets two elements of the array, in which the first is the variable and the second one is the function to update the variable.\u003c/p\u003e\u003cp\u003eSo a code like this:\n\u003ccode\u003econst [ count, setCount ] = useState(0)\u003c/code\u003e\nwould be, not destructured:\u003c/p\u003e\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"text-code-purple\"\u003econst\u003c/span\u003e array \u003cspan class=\"\"\u003e=\u003c/span\u003e \u003cspan class=\"text-code-blue\"\u003euseState\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e(\u003c/span\u003e\u003cspan class=\"\"\u003e0\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e)\u003c/span\u003e\n\u003cspan class=\"text-code-purple\"\u003econst\u003c/span\u003e count \u003cspan class=\"\"\u003e=\u003c/span\u003e array\u003cspan class=\"text-code-white\"\u003e[\u003c/span\u003e\u003cspan class=\"\"\u003e0\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e]\u003c/span\u003e\n\u003cspan class=\"text-code-purple\"\u003econst\u003c/span\u003e setCount \u003cspan class=\"\"\u003e=\u003c/span\u003e array\u003cspan class=\"text-code-white\"\u003e[\u003c/span\u003e\u003cspan class=\"\"\u003e1\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e]\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThe first exercise is quite simple if one understands React states well. Every time (unless different specified) the state changes, in any part of the component, there will be a re-render of the component virtual DOM, updating what appears on the page.\nIf I call a function on the onChange in the input, and that function changes the state (\u003ccode\u003esetCount(event.target.value)\u003c/code\u003e), then I can call the updated state in any part of the render\n\u003ccode\u003e {count ? \u0026lt;strong\u0026gt;Count is {count}\u0026lt;/strong\u0026gt; : \u0026#x27;Add a number to count\u0026#x27;}\u003c/code\u003e\u003c/p\u003e\u003cp\u003eIn the second part the task would be to use a prop in the component as initial value to pass\n\u003ccode\u003e\u0026lt;Counting initialCount={0}\u003c/code\u003e\nI find there are different ways. The best way is to setState to that initial value that is destructured in the function arguments:\u003c/p\u003e\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"text-code-purple\"\u003efunction\u003c/span\u003e \u003cspan class=\"text-code-blue\"\u003e\u003cspan class=\"\"\u003eCounting\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e(\u003c/span\u003e\u003cspan class=\"\"\u003e\u003cspan class=\"text-code-white\"\u003e{\u003c/span\u003e initialCount \u003cspan class=\"\"\u003e=\u003c/span\u003e \u003cspan class=\"\"\u003e0\u003c/span\u003e \u003cspan class=\"text-code-white\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eDestructuring is necessary because initialCount is an object so, if we\u0026#x27;re passing the argument just like it (initialCount), the result will be \u003c!-- --\u003e[Object object]\u003c!-- --\u003e.\nThe default value (= \u0026#x27;\u0026#x27;) is also necessary in case we don\u0026#x27;t pass anything as a prop. In this case we don\u0026#x27;t cause a crash because of undefined value (unless we use Typescript and we define it as possible undefined).\nSo one way is to setState(initialCount) and value=count in the input.\u003c/p\u003e\u003cp\u003eAnother possible way is to set the defaultValue of the input to the initialCount. This will have the same effect except that the state of the rendered text won\u0026#x27;t be updated until something is typed. It\u0026#x27;s possible to create a check to use the count (like a nested if but with ternary operator). However, it will make the code more difficult to read and follow in its flow.\u003c/p\u003e\u003ch2 id=\"2---useeffect\"\u003e\u003ca href=\"#2---useeffect\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003e2 - useEffect\u003c/h2\u003e\u003cp\u003eThis hook is called at every render of the component whenever its dependencies change. Or at any render if the dependency array is empty.\u003c/p\u003e\u003cp\u003eWe can persist the state: call the localstorage methods inside useEffect (getter and/or setter) \u003ccode\u003econst [name, setName] = React.useState(window.localStorage.getItem(\u0026#x27;name\u0026#x27;) || initialName)\u003c/code\u003e\nHowever in doing so we can run into a performance issue. Access to localstorage is slower than other methods.\u003c/p\u003e\u003cp\u003eThere are some workarounds for this:\u003c/p\u003e\u003cul\u003e\u003cli\u003eReact’s useState hook allows you to pass a function instead of the actual value, and then it will only call that function to get the state value when the component is rendered the first time: \u003ccode\u003eReact.useState(() =\u0026gt; someExpensiveComputation())\u003c/code\u003e ... that\u0026#x27;s the same as the callback on setState in class components\n\u003ccode\u003econst [name, setName] = React.useState(() =\u0026gt; window.localStorage.getItem(\u0026#x27;name\u0026#x27;) || initialName)\u003c/code\u003e\nIf we put a console inside the callback we cans see it\u0026#x27;s called only on the first render.\nIt should be used only for bottleneck functions that require sync time\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eOr using useEffect: \u003c/p\u003e\u003cul\u003e\u003cli\u003elazy initialization, or not reading from localStorage at every render.\u003c/li\u003e\u003cli\u003edependency array: second argument on useEffect which signals to React that your effect callback function should be called when (and only when) those dependencies change:\u003c/li\u003e\u003c/ul\u003e\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"\"\u003eReact\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e.\u003c/span\u003e\u003cspan class=\"\"\u003euseEffect\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e(\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e(\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e)\u003c/span\u003e \u003cspan class=\"\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"text-code-white\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"\"\u003ewindow\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e.\u003c/span\u003e\u003cspan class=\"\"\u003elocalStorage\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e.\u003c/span\u003e\u003cspan class=\"\"\u003esetItem\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e(\u003c/span\u003e\u003cspan class=\"text-code-green\"\u003e\u0026#x27;count\u0026#x27;\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e,\u003c/span\u003e count\u003cspan class=\"text-code-white\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"text-code-white\"\u003e}\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e,\u003c/span\u003e \u003cspan class=\"text-code-white\"\u003e[\u003c/span\u003ename\u003cspan class=\"text-code-white\"\u003e]\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eIf other states apart from name change setItem won\u0026#x27;t be called\nIf left empty, it\u0026#x27;ll be called only at the first render.\nThe state in the dependency array is an object that is compared on the render with the previous state through object comparison. If they\u0026#x27;re the same useEffect won\u0026#x27;t run , otherwise yes.\u003c/p\u003e\u003cp\u003eCustom hooks. They are external functions called inside a method. Their names start with ”use”.\nIf we have different functions inside the component method we can externalize those, even useEffect:\u003c/p\u003e\u003cp\u003eIf we have a method like this:\u003c/p\u003e\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"text-code-purple\"\u003efunction\u003c/span\u003e \u003cspan class=\"text-code-blue\"\u003e\u003cspan class=\"\"\u003eGreeting\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e(\u003c/span\u003e\u003cspan class=\"\"\u003e\u003cspan class=\"text-code-white\"\u003e{\u003c/span\u003e initialCount \u003cspan class=\"\"\u003e=\u003c/span\u003e \u003cspan class=\"\"\u003e0\u003c/span\u003e \u003cspan class=\"text-code-white\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e)\u003c/span\u003e \u003cspan class=\"text-code-white\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"text-code-purple\"\u003econst\u003c/span\u003e \u003cspan class=\"text-code-white\"\u003e[\u003c/span\u003ecount\u003cspan class=\"text-code-white\"\u003e,\u003c/span\u003e setCount\u003cspan class=\"text-code-white\"\u003e]\u003c/span\u003e \u003cspan class=\"\"\u003e=\u003c/span\u003e \u003cspan class=\"\"\u003eReact\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e.\u003c/span\u003e\u003cspan class=\"\"\u003euseState\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e(\u003c/span\u003e\n    \u003cspan class=\"text-code-white\"\u003e(\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e)\u003c/span\u003e \u003cspan class=\"\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"\"\u003ewindow\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e.\u003c/span\u003e\u003cspan class=\"\"\u003elocalStorage\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e.\u003c/span\u003e\u003cspan class=\"\"\u003egetItem\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e(\u003c/span\u003e\u003cspan class=\"text-code-green\"\u003e\u0026#x27;count\u0026#x27;\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e)\u003c/span\u003e \u003cspan class=\"\"\u003e||\u003c/span\u003e initialCount\u003cspan class=\"text-code-white\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"text-code-white\"\u003e)\u003c/span\u003e\n\n  \u003cspan class=\"\"\u003eReact\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e.\u003c/span\u003e\u003cspan class=\"\"\u003euseEffect\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e(\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e(\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e)\u003c/span\u003e \u003cspan class=\"\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"text-code-white\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"\"\u003ewindow\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e.\u003c/span\u003e\u003cspan class=\"\"\u003elocalStorage\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e.\u003c/span\u003e\u003cspan class=\"\"\u003esetItem\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e(\u003c/span\u003e\u003cspan class=\"text-code-green\"\u003e\u0026#x27;count\u0026#x27;\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e,\u003c/span\u003e count\u003cspan class=\"text-code-white\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"text-code-white\"\u003e}\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e,\u003c/span\u003e \u003cspan class=\"text-code-white\"\u003e[\u003c/span\u003ecount\u003cspan class=\"text-code-white\"\u003e]\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e)\u003c/span\u003e\n\n  \u003cspan class=\"text-code-purple\"\u003efunction\u003c/span\u003e \u003cspan class=\"text-code-blue\"\u003ehandleChange\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e(\u003c/span\u003e\u003cspan class=\"\"\u003eevent\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e)\u003c/span\u003e \u003cspan class=\"text-code-white\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"text-code-blue\"\u003esetCount\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e(\u003c/span\u003eevent\u003cspan class=\"text-code-white\"\u003e.\u003c/span\u003e\u003cspan class=\"\"\u003etarget\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e.\u003c/span\u003e\u003cspan class=\"\"\u003evalue\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"text-code-white\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eWe can convert it to this and then use it in the main method as custom hook:\u003c/p\u003e\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"text-code-purple\"\u003efunction\u003c/span\u003e \u003cspan class=\"text-code-blue\"\u003euseLocalStorageWithState\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e(\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e)\u003c/span\u003e \u003cspan class=\"text-code-white\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"text-code-purple\"\u003econst\u003c/span\u003e \u003cspan class=\"text-code-white\"\u003e[\u003c/span\u003ecount\u003cspan class=\"text-code-white\"\u003e,\u003c/span\u003e setCount\u003cspan class=\"text-code-white\"\u003e]\u003c/span\u003e \u003cspan class=\"\"\u003e=\u003c/span\u003e \u003cspan class=\"\"\u003eReact\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e.\u003c/span\u003e\u003cspan class=\"\"\u003euseState\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e(\u003c/span\u003e\n    \u003cspan class=\"text-code-white\"\u003e(\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e)\u003c/span\u003e \u003cspan class=\"\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"\"\u003ewindow\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e.\u003c/span\u003e\u003cspan class=\"\"\u003elocalStorage\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e.\u003c/span\u003e\u003cspan class=\"\"\u003egetItem\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e(\u003c/span\u003e\u003cspan class=\"text-code-green\"\u003e\u0026#x27;count\u0026#x27;\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e)\u003c/span\u003e \u003cspan class=\"\"\u003e||\u003c/span\u003e initialCount\u003cspan class=\"text-code-white\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"text-code-white\"\u003e)\u003c/span\u003e\n\n  \u003cspan class=\"\"\u003eReact\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e.\u003c/span\u003e\u003cspan class=\"\"\u003euseEffect\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e(\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e(\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e)\u003c/span\u003e \u003cspan class=\"\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"text-code-white\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"\"\u003ewindow\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e.\u003c/span\u003e\u003cspan class=\"\"\u003elocalStorage\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e.\u003c/span\u003e\u003cspan class=\"\"\u003esetItem\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e(\u003c/span\u003e\u003cspan class=\"text-code-green\"\u003e\u0026#x27;count\u0026#x27;\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e,\u003c/span\u003e count\u003cspan class=\"text-code-white\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"text-code-white\"\u003e}\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e,\u003c/span\u003e \u003cspan class=\"text-code-white\"\u003e[\u003c/span\u003ecount\u003cspan class=\"text-code-white\"\u003e]\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e)\u003c/span\u003e\n\n  \u003cspan class=\"text-code-purple\"\u003ereturn\u003c/span\u003e \u003cspan class=\"text-code-white\"\u003e[\u003c/span\u003ecount\u003cspan class=\"text-code-white\"\u003e,\u003c/span\u003e setCount\u003cspan class=\"text-code-white\"\u003e]\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e;\u003c/span\u003e\n\u003cspan class=\"text-code-white\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"text-code-purple\"\u003efunction\u003c/span\u003e \u003cspan class=\"text-code-blue\"\u003e\u003cspan class=\"\"\u003eGreeting\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e(\u003c/span\u003e\u003cspan class=\"\"\u003e\u003cspan class=\"text-code-white\"\u003e{\u003c/span\u003e initialCount\u003cspan class=\"\"\u003e=\u003c/span\u003e \u003cspan class=\"\"\u003e0\u003c/span\u003e \u003cspan class=\"text-code-white\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e)\u003c/span\u003e \u003cspan class=\"text-code-white\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"text-code-purple\"\u003econst\u003c/span\u003e \u003cspan class=\"text-code-white\"\u003e[\u003c/span\u003ecount\u003cspan class=\"text-code-white\"\u003e,\u003c/span\u003e setCount\u003cspan class=\"text-code-white\"\u003e]\u003c/span\u003e \u003cspan class=\"\"\u003e=\u003c/span\u003e \u003cspan class=\"text-code-blue\"\u003euseLocalStorageWithState\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e(\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"text-code-purple\"\u003efunction\u003c/span\u003e \u003cspan class=\"text-code-blue\"\u003ehandleChange\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e(\u003c/span\u003e\u003cspan class=\"\"\u003eevent\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e)\u003c/span\u003e \u003cspan class=\"text-code-white\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"text-code-blue\"\u003esetCount\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e(\u003c/span\u003eevent\u003cspan class=\"text-code-white\"\u003e.\u003c/span\u003e\u003cspan class=\"\"\u003etarget\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e.\u003c/span\u003e\u003cspan class=\"\"\u003evalue\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e)\u003c/span\u003e\n  \u003cspan class=\"text-code-white\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003ch4 id=\"other-notes\"\u003e\u003ca href=\"#other-notes\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eOther notes\u003c/h4\u003e\u003cul\u003e\u003cli\u003e\u003cp\u003eSetting up a callback inside useState makes the setting of the state as lazy, as it compares the states and doesn\u0026#x27;t change it if it\u0026#x27;s the same.\u003c/p\u003e\u003c/li\u003e\u003cli\u003e\u003cp\u003eIf you ar getting an error that goes like: \u0026#x27;React Hook ... is called in function ... which is neither a React function component or custom React Hook function\u0026#x27;, then it\u0026#x27;s possible that you put a wrong name to the custom hook.\nAs a React convention, your function should start with \u0026#x27;use\u0026#x27; and probably is not. For example, useGetItems.\nSo, instead of syncLocalStorageWithState, we call it useLocalStorageWithState.\u003c/p\u003e\u003c/li\u003e\u003c/ul\u003e\u003cp\u003euseLocalStorageWithState should have the same use as the useState hook, so it can return an array like useState, and we can store it in a similar array. So we have created a custom useState hook that does other stuff as well.\nWe pass as well count and initialCount as parameters \u003ccode\u003euseLocalStorageWithState(count, initialCount)\u003c/code\u003e and then making useLocalStorageWithState more generic, receiving as arguments \u003ccode\u003ekey, defaultValue\u003c/code\u003e , so the method can be reused freely and not stay chained to a count state. The same applies to the state. We can set \u003c!-- --\u003e[state, setState]\u003c!-- --\u003e and return the same.\nHaving two arguments means that also useEffect should have two in the dependency array.\u003c/p\u003e\u003cp\u003eThe logic of the flexible localStorage hook is the following:\u003c/p\u003e\u003cul\u003e\u003cli\u003eget the item from local storage\u003c/li\u003e\u003cli\u003eif present, JSON parse it and return the result\u003c/li\u003e\u003cli\u003eif not, return the default value\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eThat\u0026#x27;s for getting the state. For setting the changes using useEffect -in this case for creating/editing the local storage- se can move forward like this: once the state changes we can just stringify whatever the state will be and store it.\nSerialize will be for stringify the JSON, while deserialize for parsing it.\u003c/p\u003e\u003cp\u003eIn case as argument of useLocalStorageWithState, instead of a number, we\u0026#x27;ll pass a function, it\u0026#x27;s possible to create a check to return the results of another function.\n\u003ccode\u003econst [name, setName] = useLocalStorageWithState(\u0026#x27;name\u0026#x27;, complexCounting() )\u003c/code\u003e --\u0026gt; pass a function as default value\n\u003ccode\u003ereturn typeof defaultValue === \u0026#x27;function\u0026#x27; ? defaultValue() : defaultValue;\u003c/code\u003e --\u0026gt; return to useState the result of the method\u003c/p\u003e\u003cp\u003eThen it comes the complicated part.\nIn the above case, we are passing two parameters to useLocalStorageWithState. The first one -the key- is a string and the second a primitive value or a method.\nWhat if somebody wants to pass another value to the \u0026#x27;key\u0026#x27;? Now, for example, can be passed \u0026#x27;count\u0026#x27; as string, but maybe somebody will want to pass something different (to store a different thing in local storage, for instance).\u003c/p\u003e\u003cp\u003eThere\u0026#x27;s no direct way to change the state of the key, so what could be done is storing the key into a variable that won\u0026#x27;t trigger the render, using useRef. Following that, in useEffect we can compare the old key with the new one.\u003c/p\u003e\u003cp\u003eAccording to the docs:\u003c/p\u003e\u003cblockquote\u003e\u003cp\u003euseRef returns a mutable ref object whose .current property is initialized to the passed argument (initialValue). The returned object will persist for the full lifetime of the component.\nNote that useRef() is useful for more than the ref attribute. It’s handy for keeping any mutable value around similar to how you’d use instance fields in classes.\u003c/p\u003e\u003c/blockquote\u003e\u003cp\u003eThe difference with useState is then that useRef doesn\u0026#x27;t trigger a rerender, so with this hook we can actually set the key without triggering the rerender. The purpose of this is clear in the useEffect\u003c/p\u003e\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"text-code-purple\"\u003econst\u003c/span\u003e prevKey \u003cspan class=\"\"\u003e=\u003c/span\u003e prevKeyRef\u003cspan class=\"text-code-white\"\u003e.\u003c/span\u003e\u003cspan class=\"\"\u003ecurrent\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"text-code-purple\"\u003eif\u003c/span\u003e \u003cspan class=\"text-code-white\"\u003e(\u003c/span\u003eprevKey \u003cspan class=\"\"\u003e!==\u003c/span\u003e key\u003cspan class=\"text-code-white\"\u003e)\u003c/span\u003e \u003cspan class=\"text-code-white\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"\"\u003ewindow\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e.\u003c/span\u003e\u003cspan class=\"\"\u003elocalStorage\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e.\u003c/span\u003e\u003cspan class=\"\"\u003eremoveItem\u003c/span\u003e\u003cspan class=\"text-code-white\"\u003e(\u003c/span\u003eprevKey\u003cspan class=\"text-code-white\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"text-code-white\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eUsually we store in localStorage a value. But this value is in an object, and that object has a key. So for now it\u0026#x27;s \u0026#x27;count\u0026#x27;. But if it will be \u0026#x27;sum\u0026#x27;, and we don\u0026#x27;t remove the initial key, we\u0026#x27;ll have two objects in localStorage. So if the new key and the old one, which is stored in the useRef var, is different, we will remove the object in localStorage with the old key.\u003c/p\u003e","scope":{}},"frontMatter":{"wordCount":1539,"readingTime":{"text":"8 min read","minutes":7.685,"time":461099.99999999994,"words":1537},"slug":"learning-on-epic-react-hooks-useState-useEffect","fileName":"learning-on-epic-react-hooks-useState-useEffect.md","title":"Epic React. Hooks. UseState, useEffect. What I'm learning.","date":"2021-11-01","draft":false,"tags":["react","web development","epic react"],"summary":"A guide of what I'm learning on the Epic React workshops by Kent Dodds. This is the second one: useState + useEffect"}},"prev":{"title":"What I learnt in my first six months as a working (self-taught) developer","date":"2021-07-06","template":"post","draft":false,"tags":["insights"],"summary":"The first six months of a developer are maybe the most challenging. This is what I learnt. My mistakes and accomplishments, to become a better dev","slug":"what-learnt-in-first-six-months-self-taught-developer"},"next":{"title":"How I passed from Junior to Intermediate developer in one year","date":"2021-12-15","draft":false,"tags":["insights"],"summary":"Learning from going above junior is not easy. This is why I think I did it and what I could learn in this passage","slug":"how-passed-from-junior-to-intermediate-dev-one-year"}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"learning-on-epic-react-hooks-useState-useEffect"},"buildId":"JrHN6SXNT5iiCuUtPfJ0y","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>
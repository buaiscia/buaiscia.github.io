<!DOCTYPE html><html lang="en"><head><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-HE9Y53FXBM"></script><script async="">window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments);}
              gtag('js', new Date());
              gtag('config', 'G-HE9Y53FXBM');</script><link rel="apple-touch-icon" sizes="180x180" href="/static/favicons/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png"/><link rel="manifest" href="/static/favicons/site.webmanifest"/><link rel="mask-icon" href="/static/favicons/safari-pinned-tab.svg" color="#5bbad5"/><meta name="msapplication-TileColor" content="#da532c"/><meta name="theme-color" content="#ffffff"/><link rel="alternate" type="application/rss+xml" href="/index.xml"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><link rel="stylesheet" media="print" data-href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&amp;display=swap"/><noscript><link rel="stylesheet" data-href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&amp;display=swap"/></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');if(!e)return localStorage.setItem('theme','light'),d.add('light');if("system"===e){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else d.add(e)}catch(e){}}()</script><meta content="width=device-width, initial-scale=1" name="viewport"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="https://twitter.com/AlexBuaiscia"/><meta name="twitter:creator" content="https://twitter.com/AlexBuaiscia"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="600"/><meta property="og:locale" content="en-us"/><meta name="author" content="Alex Buaiscia"/><title>Mock an Axios call with a JSON file. – Alex Buaiscia Blog</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="How to avoid test calling a third party API with Axios using a mock JSON file"/><meta property="og:url" content="https://buaiscia.github.io/blog/sending-mock-json-response-axios"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2020-11-13T00:00:00.000Z"/><meta property="article:modified_time" content="2020-11-13T00:00:00.000Z"/><meta property="article:author" content="https://buaiscia.github.io/about"/><meta property="article:tag" content="nodejs"/><meta property="article:tag" content="web development"/><meta property="article:tag" content="api"/><meta property="og:title" content="Mock an Axios call with a JSON file."/><meta property="og:description" content="How to avoid test calling a third party API with Axios using a mock JSON file"/><meta property="og:image" content="https://buaiscia.github.io/static/images/twitter-card.png"/><meta property="og:image:alt" content="Mock an Axios call with a JSON file."/><link rel="canonical" href="https://buaiscia.github.io/blog/sending-mock-json-response-axios"/><meta name="twitter:image" content="https://buaiscia.github.io/static/images/twitter-card.png"/><script type="application/ld+json">{
    "@context": "https://schema.org",
    "@type": "Article",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https://buaiscia.github.io/blog/sending-mock-json-response-axios"
    },
    "headline": "Mock an Axios call with a JSON file.",
    "image": [
      "[object Object]"
     ],
    "datePublished": "2020-11-13T00:00:00.000Z",
    "dateModified": "2020-11-13T00:00:00.000Z",
    "author": {"@type": "Person","name": "Alex Buaiscia"},
    "publisher": {
      "@type": "Organization",
      "name": "Alex Buaiscia",
      "logo": {
        "@type": "ImageObject",
        "url": "undefined"
      }
    },
    "description": "How to avoid test calling a third party API with Axios using a mock JSON file"
  }</script><meta name="next-head-count" content="29"/><link rel="preload" href="/_next/static/css/955c566e433c371d.css" as="style"/><link rel="stylesheet" href="/_next/static/css/955c566e433c371d.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/main-0461b9c3e21c4613.js" defer=""></script><script src="/_next/static/chunks/pages/_app-2580198b41cad287.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-a8b7d2c6dc7a6ebc.js" defer=""></script><script src="/_next/static/CjejQ1CfHujmpPVW7pZ3y/_buildManifest.js" defer=""></script><script src="/_next/static/CjejQ1CfHujmpPVW7pZ3y/_ssgManifest.js" defer=""></script><script src="/_next/static/CjejQ1CfHujmpPVW7pZ3y/_middlewareManifest.js" defer=""></script><style data-href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap">@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v7/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuLyfMZs.woff) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v7/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuGKYMZs.woff) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v7/UcCO3FwrK3iLTeHuS_fvQtMwCp50KnMw2boKoduKmMEVuFuYMZs.woff) format('woff')}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v7/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v7/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v7/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v7/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v7/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v7/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v7/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v7/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v7/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v7/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v7/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v7/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v7/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v7/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v7/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2JL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v7/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa0ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v7/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2ZL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v7/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v7/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa2pL7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v7/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa25L7W0Q5n-wU.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Inter';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/inter/v7/UcC73FwrK3iLTeHuS_fvQtMwCp50KnMa1ZL7W0Q5nw.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body class="antialiased text-black bg-white dark:bg-gray-900 dark:text-white"><div id="__next" data-reactroot=""><div class="max-w-3xl px-4 mx-auto sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex flex-col justify-between h-screen"><header class="flex items-center justify-between py-10"><div><a aria-label="Alex Buaiscia Tech Blog" href="/"><div class="flex items-center justify-between"><div class="mr-3"><svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="-3 -2.75 6.5 6"><path class="logo_svg__path" fill="none" stroke="#0EA5E9" stroke-width="0.1" stroke-miterlimit="10" d="M0 0c.043 0 .082-.035.088-.088C.095-.145.064-.209 0-.25a.29.29 0 00-.265-.015A.42.42 0 00-.5 0a.547.547 0 00.058.442c.091.153.25.267.442.308A.8.8 0 00.619.619C.819.48.959.258 1 0a1.05 1.05 0 00-.205-.795A1.171 1.171 0 000-1.25a1.305 1.305 0 00-.972.278A1.428 1.428 0 00-1.5 0c-.043.406.081.821.351 1.149.28.341.693.56 1.149.601a1.81 1.81 0 001.326-.424C1.713.999 1.958.522 2 0a2.06 2.06 0 00-.497-1.503A2.186 2.186 0 000-2.25a2.302 2.302 0 00-1.679.571A2.43 2.43 0 00-2.5 0c-.043.671.187 1.34.644 1.856A2.686 2.686 0 000 2.75a2.807 2.807 0 002.033-.717A2.934 2.934 0 003 0"></path></svg></div><div class="hidden h-6 text-2xl font-semibold sm:block">Alex Buaiscia Tech Blog</div></div></a></div><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/blog">Blog</a><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/tags">Tags</a><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/about">Who&#x27;s me</a></div><button aria-label="Toggle Dark Mode" type="button" class="w-8 h-8 p-1 ml-1 mr-1 rounded sm:ml-4"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg></button><div class="sm:hidden"><button type="button" class="w-8 h-8 ml-1 mr-1 rounded" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed w-full h-full top-24 right-0 bg-gray-200 dark:bg-gray-800 opacity-95 z-10 transform ease-in-out duration-300 translate-x-full"><button type="button" aria-label="toggle modal" class="fixed w-full h-full cursor-auto focus:outline-none"></button><nav class="fixed h-full mt-8"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/blog">Blog</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags">Tags</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/about">Who&#x27;s me</a></div></nav></div></div></div></header><main class="mb-auto"><div class="max-w-3xl px-4 mx-auto sm:px-6 xl:max-w-5xl xl:px-0"><article class="xl:divide-y xl:divide-gray-200 xl:dark:divide-gray-700"><header class="pt-6 xl:pb-6"><div class="space-y-1 text-center"><dl class="space-y-10"><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2020-11-13">Friday, November 13, 2020</time></dd></div></dl><div><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">Mock an Axios call with a JSON file.</h1></div></div></header><div class="pb-8 divide-y divide-gray-200 xl:divide-y-0 dark:divide-gray-700 xl:grid xl:grid-cols-4 xl:gap-x-6" style="grid-template-rows:auto 1fr"><dl class="pt-6 pb-10 xl:pt-11 xl:border-b xl:border-gray-200 xl:dark:border-gray-700"><dt class="sr-only">Authors</dt><dd><ul class="flex justify-center space-x-8 xl:block sm:space-x-12 xl:space-x-0 xl:space-y-8"><li class="flex items-center space-x-2"><img src="https://res.cloudinary.com/buaiscia/image/upload/v1614031509/techblog/avatar_rlujgi.jpg" alt="avatar" class="w-10 h-10 rounded-full"/><dl class="text-sm font-medium leading-5 whitespace-nowrap"><dt class="sr-only">Name</dt><dd class="text-gray-900 dark:text-gray-100">Alex Buaiscia</dd><dt class="sr-only">Twitter</dt><dd><a target="_blank" rel="noopener noreferrer" href="https://twitter.com/AlexBuaiscia" class="text-blue-500 hover:text-blue-600 dark:hover:text-blue-400">@AlexBuaiscia</a></dd></dl></li></ul></dd></dl><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:pb-0 xl:col-span-3 xl:row-span-2"><div class="pt-10 pb-8 prose dark:prose-dark max-w-none"><div><p>Every now and then, working on the backend of a project, we have to deal with calling third party APIs via fetch or Axios. It&#x27;s perfectly doable also during testing if the other API has a development or stage environment to experiment with. But there are some cases in which this isn&#x27;t happening, unfortunately; or there are other cases in which stage/staging is not available (because, for example, it is busy with another branch of the project).
Or, most commonly, we don&#x27;t want to make too many calls (they could be billable). After all, tests are made for this.</p><h2 id="mocking-on-the-way-to-help"><a href="#mocking-on-the-way-to-help" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Mocking on the way to help!</h2><p>We know mocking by the testing libraries, like Jest. They are used, for example, for mocking functions and testing the returned/resolved/rejected values, among many other ways to implement them.
But what about Axios? We are in that stage of development that is happening before creating the tests (not TDD, conceded), and we don&#x27;t know the side effects of updating something or even how the response will look like.</p><p>What we have is some good documentation to implement a feature and that&#x27;s it. So how to mock the Axios call? Axios is returning an object as response. Unfortunately, we can&#x27;t pass a JSON file directly as request from Axios because the service makes only http requests, hence it thinks we&#x27;re passing a url string.</p><p>Let&#x27;s show it as an example in NodeJS with Restify as framework:</p><p>Before:</p><pre><code>public getAll = async (req, res, next) =&gt; {
        try {
             const url = &#x27;http://url&#x27;;
             const response = await axios.get(url);
             res.send(response.data)
        } catch (err) {
            next(new InternalError(errorMsg));
        }
        next();
</code></pre><p>After (wrong):</p><pre><code>public getAll = async (req, res, next) =&gt; {
        try {
             const file = &#x27;./mockFile.json&#x27;;
             const response = await axios.get(file);
             res.send(response)
        } catch (err) {
            next(new InternalError(errorMsg));
        }
        next();
// send undefined
</code></pre><p>This will throw an exception as response will be undefined (Axios does the request to a string).</p><h2 id="parsing-and-sending-a-json"><a href="#parsing-and-sending-a-json" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Parsing and sending a JSON</h2><p>The way to proceed, then, is to override Axios and return the JSON object.
However, there&#x27;s a catch. If we just send the file, like this:
<code>res.send(file)</code>
or even if we prepare it with the correct, relative path, like this:
<code>const paths = path.normalize(__dirname + &#x27;/mockFile.json&#x27;);</code>
again it won&#x27;t be read. It will be undefined because a file is, well, a part of the file system. That gives the answer to this problem: we have to use the in-built Node module &#x27;fs&#x27;, then parse it and finally send it.
Here&#x27;s how:</p><pre><code>import {readFile } from &quot;fs&quot;;

public getAll = (req, res, next) =&gt; {
        try {
            readFile(__dirname + &#x27;/mockFile.json&#x27;, &#x27;utf8&#x27;, function (err, data) {
                if (err) throw err;
                data = JSON.parse(data);
                res.send(data);
                next();
            });
        } catch (err) {
            next(new InternalError(errorMsg));
        }
</code></pre><p>If there will be an error, it will be thrown and caught by the catch method. The readFile method of fs in this case has three arguments: the path or the source to read, the encoding (optional, rarely will be different than utf8), and a callback function.
Data will contain, as an object as a matter of fact, the JSON file. We will reassign to data the parsed object and finally we can send it to the next method to use it.</p><p>That&#x27;s it! Now you can mock any kind of response and use it directly in the code to test it!</p></div></div></div><footer class="text-sm font-medium leading-5 divide-gray-200 xl:divide-y dark:divide-gray-700 xl:col-start-1 xl:row-start-2"><div class="py-4 xl:py-8"><h2 class="text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400">Tags</h2><div class="space-x-3 xl:flex xl:flex-col xl:space-x-0"><a class="text-sm font-medium text-blue-500 uppercase hover:text-blue-600 dark:hover:text-blue-400" href="/tags/nodejs">nodejs</a><a class="text-sm font-medium text-blue-500 uppercase hover:text-blue-600 dark:hover:text-blue-400" href="/tags/web-development">web-development</a><a class="text-sm font-medium text-blue-500 uppercase hover:text-blue-600 dark:hover:text-blue-400" href="/tags/api">api</a></div></div><div class="flex justify-between py-4 xl:block xl:space-y-8 xl:py-8"><div><h2 class="text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400">Previous Article</h2><div class="text-blue-500 hover:text-blue-600 dark:hover:text-blue-400"><a href="/blog/learning-on-epic-react-fundamentals">Epic React. Fundamentals. What I&#x27;m learning.</a></div></div><div><h2 class="text-xs tracking-wide text-gray-500 uppercase dark:text-gray-400">Next Article</h2><div class="text-blue-500 hover:text-blue-600 dark:hover:text-blue-400"><a href="/blog/how-transitioned-from-humanistic-to-tech-and-helped">How I transitioned from humanistic jobs to tech and development and why it is possible to start from the basics.</a></div></div></div><div class="pt-4 xl:pt-8"><a class="text-blue-500 hover:text-blue-600 dark:hover:text-blue-400" href="/blog">← Back to the blog</a></div></footer></div></article></div></main><footer class="flex flex-col items-center mt-16"><div class="flex mb-3 space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/buaiscia"><span class="sr-only">github</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400 h-6 w-6"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/in/alex-buaiscia/"><span class="sr-only">linkedin</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400 h-6 w-6"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://twitter.com/AlexBuaiscia"><span class="sr-only">twitter</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current text-gray-700 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400 h-6 w-6"><path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"></path></svg></a></div><div class="flex mb-2 space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>Alex Buaiscia</div><div> • </div><div>© 2022</div><div> • </div><a href="/">Alex Buaiscia Blog</a><br/><br/><br/></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":{"compiledSource":"\"use strict\";\n\nvar _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i \u003c arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i \u003c sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) \u003e= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i \u003c sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) \u003e= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar layoutProps = {};\nvar MDXLayout = \"wrapper\";\n\nfunction MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"Every now and then, working on the backend of a project, we have to deal with calling third party APIs via fetch or Axios. It's perfectly doable also during testing if the other API has a development or stage environment to experiment with. But there are some cases in which this isn't happening, unfortunately; or there are other cases in which stage/staging is not available (because, for example, it is busy with another branch of the project).\\nOr, most commonly, we don't want to make too many calls (they could be billable). After all, tests are made for this.\"), mdx(\"h2\", {\n    \"id\": \"mocking-on-the-way-to-help\"\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#mocking-on-the-way-to-help\",\n    \"aria-hidden\": \"true\",\n    \"tabIndex\": -1\n  }, mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"icon icon-link\"\n  })), \"Mocking on the way to help!\"), mdx(\"p\", null, \"We know mocking by the testing libraries, like Jest. They are used, for example, for mocking functions and testing the returned/resolved/rejected values, among many other ways to implement them.\\nBut what about Axios? We are in that stage of development that is happening before creating the tests (not TDD, conceded), and we don't know the side effects of updating something or even how the response will look like.\"), mdx(\"p\", null, \"What we have is some good documentation to implement a feature and that's it. So how to mock the Axios call? Axios is returning an object as response. Unfortunately, we can't pass a JSON file directly as request from Axios because the service makes only http requests, hence it thinks we're passing a url string.\"), mdx(\"p\", null, \"Let's show it as an example in NodeJS with Restify as framework:\"), mdx(\"p\", null, \"Before:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"public getAll = async (req, res, next) =\u003e {\\n        try {\\n             const url = 'http://url';\\n             const response = await axios.get(url);\\n             res.send(response.data)\\n        } catch (err) {\\n            next(new InternalError(errorMsg));\\n        }\\n        next();\\n\")), mdx(\"p\", null, \"After (wrong):\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"public getAll = async (req, res, next) =\u003e {\\n        try {\\n             const file = './mockFile.json';\\n             const response = await axios.get(file);\\n             res.send(response)\\n        } catch (err) {\\n            next(new InternalError(errorMsg));\\n        }\\n        next();\\n// send undefined\\n\")), mdx(\"p\", null, \"This will throw an exception as response will be undefined (Axios does the request to a string).\"), mdx(\"h2\", {\n    \"id\": \"parsing-and-sending-a-json\"\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#parsing-and-sending-a-json\",\n    \"aria-hidden\": \"true\",\n    \"tabIndex\": -1\n  }, mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"icon icon-link\"\n  })), \"Parsing and sending a JSON\"), mdx(\"p\", null, \"The way to proceed, then, is to override Axios and return the JSON object.\\nHowever, there's a catch. If we just send the file, like this:\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"res.send(file)\"), \"\\nor even if we prepare it with the correct, relative path, like this:\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"const paths = path.normalize(__dirname + '/mockFile.json');\"), \"\\nagain it won't be read. It will be undefined because a file is, well, a part of the file system. That gives the answer to this problem: we have to use the in-built Node module 'fs', then parse it and finally send it.\\nHere's how:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"import {readFile } from \\\"fs\\\";\\n\\npublic getAll = (req, res, next) =\u003e {\\n        try {\\n            readFile(__dirname + '/mockFile.json', 'utf8', function (err, data) {\\n                if (err) throw err;\\n                data = JSON.parse(data);\\n                res.send(data);\\n                next();\\n            });\\n        } catch (err) {\\n            next(new InternalError(errorMsg));\\n        }\\n\")), mdx(\"p\", null, \"If there will be an error, it will be thrown and caught by the catch method. The readFile method of fs in this case has three arguments: the path or the source to read, the encoding (optional, rarely will be different than utf8), and a callback function.\\nData will contain, as an object as a matter of fact, the JSON file. We will reassign to data the parsed object and finally we can send it to the next method to use it.\"), mdx(\"p\", null, \"That's it! Now you can mock any kind of response and use it directly in the code to test it!\"));\n}\n\n;\nMDXContent.isMDXComponent = true;","renderedOutput":"\u003cp\u003eEvery now and then, working on the backend of a project, we have to deal with calling third party APIs via fetch or Axios. It\u0026#x27;s perfectly doable also during testing if the other API has a development or stage environment to experiment with. But there are some cases in which this isn\u0026#x27;t happening, unfortunately; or there are other cases in which stage/staging is not available (because, for example, it is busy with another branch of the project).\nOr, most commonly, we don\u0026#x27;t want to make too many calls (they could be billable). After all, tests are made for this.\u003c/p\u003e\u003ch2 id=\"mocking-on-the-way-to-help\"\u003e\u003ca href=\"#mocking-on-the-way-to-help\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eMocking on the way to help!\u003c/h2\u003e\u003cp\u003eWe know mocking by the testing libraries, like Jest. They are used, for example, for mocking functions and testing the returned/resolved/rejected values, among many other ways to implement them.\nBut what about Axios? We are in that stage of development that is happening before creating the tests (not TDD, conceded), and we don\u0026#x27;t know the side effects of updating something or even how the response will look like.\u003c/p\u003e\u003cp\u003eWhat we have is some good documentation to implement a feature and that\u0026#x27;s it. So how to mock the Axios call? Axios is returning an object as response. Unfortunately, we can\u0026#x27;t pass a JSON file directly as request from Axios because the service makes only http requests, hence it thinks we\u0026#x27;re passing a url string.\u003c/p\u003e\u003cp\u003eLet\u0026#x27;s show it as an example in NodeJS with Restify as framework:\u003c/p\u003e\u003cp\u003eBefore:\u003c/p\u003e\u003cpre\u003e\u003ccode\u003epublic getAll = async (req, res, next) =\u0026gt; {\n        try {\n             const url = \u0026#x27;http://url\u0026#x27;;\n             const response = await axios.get(url);\n             res.send(response.data)\n        } catch (err) {\n            next(new InternalError(errorMsg));\n        }\n        next();\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eAfter (wrong):\u003c/p\u003e\u003cpre\u003e\u003ccode\u003epublic getAll = async (req, res, next) =\u0026gt; {\n        try {\n             const file = \u0026#x27;./mockFile.json\u0026#x27;;\n             const response = await axios.get(file);\n             res.send(response)\n        } catch (err) {\n            next(new InternalError(errorMsg));\n        }\n        next();\n// send undefined\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThis will throw an exception as response will be undefined (Axios does the request to a string).\u003c/p\u003e\u003ch2 id=\"parsing-and-sending-a-json\"\u003e\u003ca href=\"#parsing-and-sending-a-json\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eParsing and sending a JSON\u003c/h2\u003e\u003cp\u003eThe way to proceed, then, is to override Axios and return the JSON object.\nHowever, there\u0026#x27;s a catch. If we just send the file, like this:\n\u003ccode\u003eres.send(file)\u003c/code\u003e\nor even if we prepare it with the correct, relative path, like this:\n\u003ccode\u003econst paths = path.normalize(__dirname + \u0026#x27;/mockFile.json\u0026#x27;);\u003c/code\u003e\nagain it won\u0026#x27;t be read. It will be undefined because a file is, well, a part of the file system. That gives the answer to this problem: we have to use the in-built Node module \u0026#x27;fs\u0026#x27;, then parse it and finally send it.\nHere\u0026#x27;s how:\u003c/p\u003e\u003cpre\u003e\u003ccode\u003eimport {readFile } from \u0026quot;fs\u0026quot;;\n\npublic getAll = (req, res, next) =\u0026gt; {\n        try {\n            readFile(__dirname + \u0026#x27;/mockFile.json\u0026#x27;, \u0026#x27;utf8\u0026#x27;, function (err, data) {\n                if (err) throw err;\n                data = JSON.parse(data);\n                res.send(data);\n                next();\n            });\n        } catch (err) {\n            next(new InternalError(errorMsg));\n        }\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eIf there will be an error, it will be thrown and caught by the catch method. The readFile method of fs in this case has three arguments: the path or the source to read, the encoding (optional, rarely will be different than utf8), and a callback function.\nData will contain, as an object as a matter of fact, the JSON file. We will reassign to data the parsed object and finally we can send it to the next method to use it.\u003c/p\u003e\u003cp\u003eThat\u0026#x27;s it! Now you can mock any kind of response and use it directly in the code to test it!\u003c/p\u003e","scope":{}},"frontMatter":{"wordCount":569,"readingTime":{"text":"3 min read","minutes":2.835,"time":170100,"words":567},"slug":"sending-mock-json-response-axios","fileName":"sending-mock-json-response-axios.mdx","title":"Mock an Axios call with a JSON file.","date":"2020-11-13","draft":false,"tags":["nodejs","web development","api"],"summary":"How to avoid test calling a third party API with Axios using a mock JSON file"}},"prev":{"title":"Epic React. Fundamentals. What I'm learning.","date":"2020-10-30","draft":false,"tags":["react","web development","epic react"],"summary":"A guide of what I'm learning on the Epic React workshopds by Kent Dodds. This is the first one: fundamentals","slug":"learning-on-epic-react-fundamentals"},"next":{"title":"How I transitioned from humanistic jobs to tech and development and why it is possible to start from the basics.","date":"2020-12-02","draft":false,"tags":["insights"],"summary":"Transitioning from literature and languages to tech was not easy. Making a career from basic roles to developer is possible, and even better sometimes.","slug":"how-transitioned-from-humanistic-to-tech-and-helped"}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"sending-mock-json-response-axios"},"buildId":"CjejQ1CfHujmpPVW7pZ3y","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>
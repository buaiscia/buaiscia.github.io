<!DOCTYPE html><html lang="en"><head><link rel="apple-touch-icon" sizes="180x180" href="/static/favicons/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png"/><link rel="manifest" href="/static/favicons/site.webmanifest"/><link rel="mask-icon" href="/static/favicons/safari-pinned-tab.svg" color="#5bbad5"/><meta name="msapplication-TileColor" content="#da532c"/><meta name="theme-color" content="#ffffff"/><link rel="alternate" type="application/rss+xml" href="/index.xml"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&amp;display=swap"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&amp;display=swap" media="print"/><noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&amp;display=swap"/></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous"/><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');if(!e)return localStorage.setItem('theme','light'),d.add('light');if("system"===e){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else d.add(e)}catch(e){}}()</script><meta content="width=device-width, initial-scale=1" name="viewport"/><title>Alex Buaiscia Blog</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="A tech blog of development"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="https://twitter.com/AlexBuaiscia"/><meta name="twitter:creator" content="https://twitter.com/AlexBuaiscia"/><meta property="og:url" content="https://buaiscia.github.io"/><meta property="og:type" content="website"/><meta property="og:title" content="Alex Buaiscia Blog"/><meta property="og:description" content="A tech blog of development"/><meta property="og:image" content="https://buaiscia.github.io/static/images/twitter-card.png"/><meta property="og:image:alt" content="Alex Buaiscia Blog"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="600"/><meta property="og:locale" content="en-us"/><meta name="author" content="Alex Buaiscia"/><meta name="next-head-count" content="20"/><link rel="preload" href="/_next/static/css/b36705e52034923db1c6.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b36705e52034923db1c6.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-f22e9874a1e2c26541ea.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.c8e7d1406e41c62958d6.js" as="script"/><link rel="preload" href="/_next/static/chunks/bbd776c9508c221b4dea2d947302e2a4c5be009b.9fbf4a83f1e2236cbcd2.js" as="script"/><link rel="preload" href="/_next/static/chunks/5e22f815a215592c6a5f19c779112441096880a5.c88594719f2de2d20b63.js" as="script"/><link rel="preload" href="/_next/static/chunks/c9787b2e67d04485ea556b79e503c7f6cc1ff4d5.63394ce1ab43dabfc143.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-b15f4062896a44e99538.js" as="script"/><link rel="preload" href="/_next/static/chunks/52916a2fbede746e315910e61cf72e23ae28baf9.6c4b1c8ba3f2908378c4.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/blog/%5Bslug%5D-da4ab3a84120f7875cdd.js" as="script"/></head><body class="antialiased text-black bg-white dark:bg-gray-900 dark:text-white"><div id="__next"><div class="max-w-3xl px-4 mx-auto sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex flex-col justify-between h-screen"><header class="flex items-center justify-between py-10"><div><a aria-label="Alex Buaiscia Tech Blog" href="/"><div class="flex items-center justify-between"><div class="mr-3"><svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="-3 -2.75 6.5 6"><path class="logo_svg__path" fill="none" stroke="#0EA5E9" stroke-width="0.1" stroke-miterlimit="10" d="M0 0c.043 0 .082-.035.088-.088C.095-.145.064-.209 0-.25a.29.29 0 00-.265-.015A.42.42 0 00-.5 0a.547.547 0 00.058.442c.091.153.25.267.442.308A.8.8 0 00.619.619C.819.48.959.258 1 0a1.05 1.05 0 00-.205-.795A1.171 1.171 0 000-1.25a1.305 1.305 0 00-.972.278A1.428 1.428 0 00-1.5 0c-.043.406.081.821.351 1.149.28.341.693.56 1.149.601a1.81 1.81 0 001.326-.424C1.713.999 1.958.522 2 0a2.06 2.06 0 00-.497-1.503A2.186 2.186 0 000-2.25a2.302 2.302 0 00-1.679.571A2.43 2.43 0 00-2.5 0c-.043.671.187 1.34.644 1.856A2.686 2.686 0 000 2.75a2.807 2.807 0 002.033-.717A2.934 2.934 0 003 0"></path></svg></div><div class="hidden h-6 text-2xl font-semibold sm:block">Alex Buaiscia Tech Blog</div></div></a></div><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/blog">Blog</a><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/tags">Tags</a><a class="p-1 font-medium text-gray-900 sm:p-4 dark:text-gray-100" href="/about">Who&#x27;s me</a></div><button aria-label="Toggle Dark Mode" type="button" class="w-8 h-8 p-1 ml-1 mr-1 rounded sm:ml-4"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg></button><div class="sm:hidden"><button type="button" class="w-8 h-8 ml-1 mr-1 rounded" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed w-full h-full top-24 right-0 bg-gray-200 dark:bg-gray-800 opacity-95 z-10 transform ease-in-out duration-300 translate-x-full"><button type="button" aria-label="toggle modal" class="fixed w-full h-full cursor-auto focus:outline-none"></button><nav class="fixed h-full mt-8"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/blog">Blog</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags">Tags</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/about">Who&#x27;s me</a></div></nav></div></div></div></header><main class="mb-auto"><div class="mt-24 text-center"><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">Under Construction<!-- --> <span role="img" aria-label="roadwork sign">🚧</span></h1></div></main><footer class="flex flex-col items-center mt-16"><div class="flex mb-3 space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/buaiscia"><span class="sr-only">github</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400 h-6 w-6"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/in/alex-buaiscia/"><span class="sr-only">linkedin</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400 h-6 w-6"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://twitter.com/AlexBuaiscia"><span class="sr-only">twitter</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="fill-current text-gray-700 dark:text-gray-200 hover:text-blue-500 dark:hover:text-blue-400 h-6 w-6"><path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"></path></svg></a></div><div class="flex mb-2 space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>Alex Buaiscia</div><div> • </div><div>© 2021</div><div> • </div><a href="/">Alex Buaiscia Blog</a><br/><br/><br/></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":{"compiledSource":"\"use strict\";\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i \u003c arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i \u003c sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) \u003e= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i \u003c sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) \u003e= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar layoutProps = {};\nvar MDXLayout = \"wrapper\";\n\nfunction MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"-- in controlled components value is changed/updated by state and uncontrolled by event handlers\"), mdx(\"h2\", {\n    \"id\": \"1---usestate\"\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#1---usestate\",\n    \"aria-hidden\": \"true\",\n    \"tabIndex\": -1\n  }, mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"icon icon-link\"\n  })), \"1 - useState\"), mdx(\"p\", null, \"THe interesting part of useState is how under the hood is nothing else but an array declaration. When it's used, it gets two elements of the array, in which the first is the variable and the second one is the function to update the variable.\\nSo a code like this:\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"const [ count, setCount ] = useState(0)\"), \"\\nnot destructured:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"const array = useState(0)\\nconst count = array[0]\\nconst setCount = array[1]\\n\")), mdx(\"p\", null, \"The first exercise is quite simple if one understands React states well. Everytime (unless different specified) the state changes, in any part of the component, there will be a re-render (of the page or component depending) of the virtual DOM hence updating what appears on the page.\\nIf I call a function on the onChange in the input, and that function changes the state (setCount(event.target.value)), then I can call the updated state in any part of the render\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \" {count ? \u003cstrong\u003eCount is {count}\u003c/strong\u003e : 'Add a number to count'}\")), mdx(\"p\", null, \"In the second part the task would be to use a prop in the component as initial value to pass\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"\u003cCounting initialCount=0\"), \"\\nI find there are different ways. The best way is to setState to that initial value that is destructured in the function arguments:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"function Counting({ initialCount = 0 })\\n\")), mdx(\"p\", null, \"Destructuring is necessary because initial name is an object so, if passing the argument just like (initialCount), the result will be a \", \"[Object object]\", \".\\nThe default value (= '') is also necessary in case we don't pass anything as a prop. In this case we don't cause a crash because of undefined value.\\nSo one way is to setState(initialCount) and value=count in the input.\"), mdx(\"p\", null, \"Another possible way is to set the defaultValue of the input to the initialCount. This will have the same effect except that the state of the rendered text won't be updated until something is typed. It's possible to create a check to use the count (like a nested if but with ternary operator). However, it will make the code more difficult to read and follow in its flow.\"), mdx(\"h2\", {\n    \"id\": \"2---useeffect\"\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#2---useeffect\",\n    \"aria-hidden\": \"true\",\n    \"tabIndex\": -1\n  }, mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"icon icon-link\"\n  })), \"2 - useEffect\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"it's called every render of the component, including the first and every time the state changes\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"to persist the state, call the localstorage methods inside useEffect \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"const [name, setName] = React.useState(window.localStorage.getItem('name') || initialName)\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"localStorage performance issue - slow\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"React\\u2019s useState hook allows you to pass a function instead of the actual value, and then it will only call that function to get the state value when the component is rendered the first time: \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"React.useState(() =\u003e someExpensiveComputation())\"), \" ... that's the same as the callback on setState in class components\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"lazy initialization = not reading from localStorage every render\\n--\u003e create a callback function: useEffect\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"const [name, setName] = React.useState(() =\u003e window.localStorage.getItem('name') || initialName)\"), \"\\nIf we put a console inside the callback we cans see it's called only on the first render\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"To be used only for bottleneck functions that require sync time\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"dependency array: second argument on useEffect which signals to React that your effect callback function should be called when (and only when) those dependencies change:\"))), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"React.useEffect(() =\u003e {\\n    window.localStorage.setItem('count', count)\\n  }, [name])\\n\")), mdx(\"p\", null, \"if other states apart fron name change setItem won't be called\\nIf left empty it's like never use useEffect with any state with useEffect\\nThe state in the dependency array is an object that is compared on the render with the previous state with object comparation. If it's the same won't run useEffect, otherwise yes.\"), mdx(\"p\", null, \"custom hooks: external function called inside the hook whose name starts with \\u201Duse\\u201D.\\nIf we have different functions inside the compoenent method we can externilize those, even useEffect:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"function Greeting({ initialCount = 0 }) {\\n  const [count, setCount] = React.useState(\\n    () =\u003e window.localStorage.getItem('count') || initialCount,\\n  )\\n\\n  React.useEffect(() =\u003e {\\n    window.localStorage.setItem('count', count)\\n  }, [count])\\n\\n  function handleChange(event) {\\n    setCount(event.target.value)\\n  }\\n\")), mdx(\"p\", null, \"to --\u003e\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"function useLocalStorageWithState() {\\n  const [count, setCount] = React.useState(\\n    () =\u003e window.localStorage.getItem('count') || initialCount,\\n  )\\n\\n  React.useEffect(() =\u003e {\\n    window.localStorage.setItem('count', count)\\n  }, [count])\\n\\n  return [count, setCount];\\n}\\n\\nfunction Greeting({ initialCount= 0 }) {\\n  const [count, setCount] = useLocalStorageWithState()\\n  function handleChange(event) {\\n    setCount(event.target.value)\\n  }\\n\")), mdx(\"p\", null, \"useLocalStorageWithState should have the same use as the useState hook, so it can return an array like useState, and we can store in a same array. So we have created a customed useState hook that does other stuff as well.\\nWe pass as well count and initialCount as parameters \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"useLocalStorageWithState(count, initialCount)\"), \" and then making useLocalStorageWithState more generic, receiving as arguments \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"key, defaultValue\"), \" , so the method can be reused freely and not stay chained to a count state. The same applies to the state. We can set \", \"[state, setState]\", \" and return the same.\\nHaving two arguments means that also useEffect should have two in the dependency array.\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"flexible localStorage hook. This was the most complex part of the workshop to think about. The solution is not so complicated, but to be honest I couldn't manage until checking the video how to make this logic work (ok maybe it's because I'm tired \\uD83D\\uDE05)\\nAnd the logic is the following:\", mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"get the item from local storage\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"if present, JSON parse it and return the result\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"if not, return the default value\")))), mdx(\"p\", null, \"Thant's for setting the state; for making the changes (useEffect), in this case for creating/editing the local storage, once the state changes we can just stringify whatever the state will be and store it.\"), mdx(\"p\", null, \"In case as argument of useLocalStorageWithState, instead of a number, we'll pass a function, it's possible to create a check to return the results of another function.\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"const [name, setName] = useLocalStorageWithState('name', complexCounting() )\"), \" --\u003e pass a function as default value\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"return typeof defaultValue === 'function' ? defaultValue() : defaultValue;\"), \" --\u003e return to useState the result of the method\"), mdx(\"p\", null, \"Then it comes the part that was beyond my imagination. The case is what if somebody wants to pass another value to the 'key'? Now it's passed 'count' as string, but maybe somebody will change it.\\nThere's no direct way to change the state of the key, so what is done is store the key into a var that won't trigger the render using useRef. Following that, in useEffect we can compare the old key with the new one.\"), mdx(\"p\", null, \"According to the docs:\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"useRef returns a mutable ref object whose .current property is initialized to the passed argument (initialValue). The returned object will persist for the full lifetime of the component.\\nNote that useRef() is useful for more than the ref attribute. It\\u2019s handy for keeping any mutable value around similar to how you\\u2019d use instance fields in classes.\")), mdx(\"p\", null, \"The difference with useState is then that useRef doesn't trigger a rerender, so with this hook we can actually set the key without triggering the rerender. The purpose of this is clear in the useEffect.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"const prevKey = prevKeyRef.current;\\n    if (prevKey !== key) {\\n      window.localStorage.removeItem(prevKey)\\n    }\\n\")), mdx(\"p\", null, \"That means that usually we store in localStorage a value. But this value is in an object, and that object has a key. So for now it's 'count'. But if it will be 'sum', and we don't remove the initial key, we'll have two objects in localStorage. So if the new key and the old one, which is stored in the useRef var, is different, we will remove the obect in localStorage with the old key.\"), mdx(\"h2\", {\n    \"id\": \"3---lifting-and-colocating-state\"\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#3---lifting-and-colocating-state\",\n    \"aria-hidden\": \"true\",\n    \"tabIndex\": -1\n  }, mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"icon icon-link\"\n  })), \"3 - Lifting and Colocating state\"), mdx(\"p\", null, \"Lifting state is when you have state managed inside a component but a parent component needs it to render it or display it somewhere else.\\nSo when it's needed to lifting state, we take that state and find the least common parent between the two components. So the state is lifted from a lower branch of the family -or the tree- to a higher one.\"), mdx(\"p\", null, \"Colocating state, instead, is to place the state management the furthest down the tree as possible where not shared by a parent component. A state correctly colocated helps React to not having to render the whole application for just, for example, an input change.\\nIf a state is used only by a component up the tree, it's probably possible to refactor it colocating the state in the sibling component that is managing it.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"  const [name, setName] = React.useState('')\\n  const [animal, setAnimal] = React.useState('')\\n  return (\\n      \u003cName name={name} onNameChange={event =\u003e setName(event.currentTarget.value)} /\u003e\\n      \u003cFavoriteAnimal animal={animal} onAnimalChange={event =\u003e setAnimal(event.currentTarget.value)} /\u003e\\n      \u003cDisplay animal={animal} /\u003e\\n  )\\n\")), mdx(\"p\", null, \"In the above case, for example, the animal state was lifted to the parent component as it's used by the Display component as well. But the name state is not used, so it can be colocated to Name component only. This will result like this:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"function Name() {\\n  const [name, setName] = React.useState('')\\n\\n  return (\\n    \u003cdiv\u003e\\n      \u003clabel htmlFor=\\\"name\\\"\u003eName: \u003c/label\u003e\\n      \u003cinput id=\\\"name\\\" value={name} onChange={event =\u003e setName(event.currentTarget.value)} /\u003e\\n    \u003c/div\u003e\\n  )\\n}\\n\\nconst [animal, setAnimal] = React.useState('')\\n  return (\\n    \u003cform\u003e\\n      \u003cName /\u003e\\n      \u003cFavoriteAnimal animal={animal} onAnimalChange={event =\u003e setAnimal(event.currentTarget.value)} /\u003e\\n      \u003cDisplay animal={animal} /\u003e\\n  )\\n\")));\n}\n\n;\nMDXContent.isMDXComponent = true;","renderedOutput":"\u003cp\u003e-- in controlled components value is changed/updated by state and uncontrolled by event handlers\u003c/p\u003e\u003ch2 id=\"1---usestate\"\u003e\u003ca href=\"#1---usestate\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003e1 - useState\u003c/h2\u003e\u003cp\u003eTHe interesting part of useState is how under the hood is nothing else but an array declaration. When it\u0026#x27;s used, it gets two elements of the array, in which the first is the variable and the second one is the function to update the variable.\nSo a code like this:\n\u003ccode\u003econst [ count, setCount ] = useState(0)\u003c/code\u003e\nnot destructured:\u003c/p\u003e\u003cpre\u003e\u003ccode\u003econst array = useState(0)\nconst count = array[0]\nconst setCount = array[1]\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThe first exercise is quite simple if one understands React states well. Everytime (unless different specified) the state changes, in any part of the component, there will be a re-render (of the page or component depending) of the virtual DOM hence updating what appears on the page.\nIf I call a function on the onChange in the input, and that function changes the state (setCount(event.target.value)), then I can call the updated state in any part of the render\n\u003ccode\u003e {count ? \u0026lt;strong\u0026gt;Count is {count}\u0026lt;/strong\u0026gt; : \u0026#x27;Add a number to count\u0026#x27;}\u003c/code\u003e\u003c/p\u003e\u003cp\u003eIn the second part the task would be to use a prop in the component as initial value to pass\n\u003ccode\u003e\u0026lt;Counting initialCount=0\u003c/code\u003e\nI find there are different ways. The best way is to setState to that initial value that is destructured in the function arguments:\u003c/p\u003e\u003cpre\u003e\u003ccode\u003efunction Counting({ initialCount = 0 })\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eDestructuring is necessary because initial name is an object so, if passing the argument just like (initialCount), the result will be a \u003c!-- --\u003e[Object object]\u003c!-- --\u003e.\nThe default value (= \u0026#x27;\u0026#x27;) is also necessary in case we don\u0026#x27;t pass anything as a prop. In this case we don\u0026#x27;t cause a crash because of undefined value.\nSo one way is to setState(initialCount) and value=count in the input.\u003c/p\u003e\u003cp\u003eAnother possible way is to set the defaultValue of the input to the initialCount. This will have the same effect except that the state of the rendered text won\u0026#x27;t be updated until something is typed. It\u0026#x27;s possible to create a check to use the count (like a nested if but with ternary operator). However, it will make the code more difficult to read and follow in its flow.\u003c/p\u003e\u003ch2 id=\"2---useeffect\"\u003e\u003ca href=\"#2---useeffect\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003e2 - useEffect\u003c/h2\u003e\u003cul\u003e\u003cli\u003e\u003cp\u003eit\u0026#x27;s called every render of the component, including the first and every time the state changes\u003c/p\u003e\u003c/li\u003e\u003cli\u003e\u003cp\u003eto persist the state, call the localstorage methods inside useEffect \u003ccode\u003econst [name, setName] = React.useState(window.localStorage.getItem(\u0026#x27;name\u0026#x27;) || initialName)\u003c/code\u003e\u003c/p\u003e\u003c/li\u003e\u003cli\u003e\u003cp\u003elocalStorage performance issue - slow\u003c/p\u003e\u003c/li\u003e\u003cli\u003e\u003cp\u003eReact’s useState hook allows you to pass a function instead of the actual value, and then it will only call that function to get the state value when the component is rendered the first time: \u003ccode\u003eReact.useState(() =\u0026gt; someExpensiveComputation())\u003c/code\u003e ... that\u0026#x27;s the same as the callback on setState in class components\u003c/p\u003e\u003c/li\u003e\u003cli\u003e\u003cp\u003elazy initialization = not reading from localStorage every render\n--\u0026gt; create a callback function: useEffect\n\u003ccode\u003econst [name, setName] = React.useState(() =\u0026gt; window.localStorage.getItem(\u0026#x27;name\u0026#x27;) || initialName)\u003c/code\u003e\nIf we put a console inside the callback we cans see it\u0026#x27;s called only on the first render\u003c/p\u003e\u003c/li\u003e\u003cli\u003e\u003cp\u003eTo be used only for bottleneck functions that require sync time\u003c/p\u003e\u003c/li\u003e\u003cli\u003e\u003cp\u003edependency array: second argument on useEffect which signals to React that your effect callback function should be called when (and only when) those dependencies change:\u003c/p\u003e\u003c/li\u003e\u003c/ul\u003e\u003cpre\u003e\u003ccode\u003eReact.useEffect(() =\u0026gt; {\n    window.localStorage.setItem(\u0026#x27;count\u0026#x27;, count)\n  }, [name])\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eif other states apart fron name change setItem won\u0026#x27;t be called\nIf left empty it\u0026#x27;s like never use useEffect with any state with useEffect\nThe state in the dependency array is an object that is compared on the render with the previous state with object comparation. If it\u0026#x27;s the same won\u0026#x27;t run useEffect, otherwise yes.\u003c/p\u003e\u003cp\u003ecustom hooks: external function called inside the hook whose name starts with ”use”.\nIf we have different functions inside the compoenent method we can externilize those, even useEffect:\u003c/p\u003e\u003cpre\u003e\u003ccode\u003efunction Greeting({ initialCount = 0 }) {\n  const [count, setCount] = React.useState(\n    () =\u0026gt; window.localStorage.getItem(\u0026#x27;count\u0026#x27;) || initialCount,\n  )\n\n  React.useEffect(() =\u0026gt; {\n    window.localStorage.setItem(\u0026#x27;count\u0026#x27;, count)\n  }, [count])\n\n  function handleChange(event) {\n    setCount(event.target.value)\n  }\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eto --\u0026gt;\u003c/p\u003e\u003cpre\u003e\u003ccode\u003efunction useLocalStorageWithState() {\n  const [count, setCount] = React.useState(\n    () =\u0026gt; window.localStorage.getItem(\u0026#x27;count\u0026#x27;) || initialCount,\n  )\n\n  React.useEffect(() =\u0026gt; {\n    window.localStorage.setItem(\u0026#x27;count\u0026#x27;, count)\n  }, [count])\n\n  return [count, setCount];\n}\n\nfunction Greeting({ initialCount= 0 }) {\n  const [count, setCount] = useLocalStorageWithState()\n  function handleChange(event) {\n    setCount(event.target.value)\n  }\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003euseLocalStorageWithState should have the same use as the useState hook, so it can return an array like useState, and we can store in a same array. So we have created a customed useState hook that does other stuff as well.\nWe pass as well count and initialCount as parameters \u003ccode\u003euseLocalStorageWithState(count, initialCount)\u003c/code\u003e and then making useLocalStorageWithState more generic, receiving as arguments \u003ccode\u003ekey, defaultValue\u003c/code\u003e , so the method can be reused freely and not stay chained to a count state. The same applies to the state. We can set \u003c!-- --\u003e[state, setState]\u003c!-- --\u003e and return the same.\nHaving two arguments means that also useEffect should have two in the dependency array.\u003c/p\u003e\u003cul\u003e\u003cli\u003eflexible localStorage hook. This was the most complex part of the workshop to think about. The solution is not so complicated, but to be honest I couldn\u0026#x27;t manage until checking the video how to make this logic work (ok maybe it\u0026#x27;s because I\u0026#x27;m tired 😅)\nAnd the logic is the following:\u003cul\u003e\u003cli\u003eget the item from local storage\u003c/li\u003e\u003cli\u003eif present, JSON parse it and return the result\u003c/li\u003e\u003cli\u003eif not, return the default value\u003c/li\u003e\u003c/ul\u003e\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eThant\u0026#x27;s for setting the state; for making the changes (useEffect), in this case for creating/editing the local storage, once the state changes we can just stringify whatever the state will be and store it.\u003c/p\u003e\u003cp\u003eIn case as argument of useLocalStorageWithState, instead of a number, we\u0026#x27;ll pass a function, it\u0026#x27;s possible to create a check to return the results of another function.\n\u003ccode\u003econst [name, setName] = useLocalStorageWithState(\u0026#x27;name\u0026#x27;, complexCounting() )\u003c/code\u003e --\u0026gt; pass a function as default value\n\u003ccode\u003ereturn typeof defaultValue === \u0026#x27;function\u0026#x27; ? defaultValue() : defaultValue;\u003c/code\u003e --\u0026gt; return to useState the result of the method\u003c/p\u003e\u003cp\u003eThen it comes the part that was beyond my imagination. The case is what if somebody wants to pass another value to the \u0026#x27;key\u0026#x27;? Now it\u0026#x27;s passed \u0026#x27;count\u0026#x27; as string, but maybe somebody will change it.\nThere\u0026#x27;s no direct way to change the state of the key, so what is done is store the key into a var that won\u0026#x27;t trigger the render using useRef. Following that, in useEffect we can compare the old key with the new one.\u003c/p\u003e\u003cp\u003eAccording to the docs:\u003c/p\u003e\u003cblockquote\u003e\u003cp\u003euseRef returns a mutable ref object whose .current property is initialized to the passed argument (initialValue). The returned object will persist for the full lifetime of the component.\nNote that useRef() is useful for more than the ref attribute. It’s handy for keeping any mutable value around similar to how you’d use instance fields in classes.\u003c/p\u003e\u003c/blockquote\u003e\u003cp\u003eThe difference with useState is then that useRef doesn\u0026#x27;t trigger a rerender, so with this hook we can actually set the key without triggering the rerender. The purpose of this is clear in the useEffect.\u003c/p\u003e\u003cpre\u003e\u003ccode\u003econst prevKey = prevKeyRef.current;\n    if (prevKey !== key) {\n      window.localStorage.removeItem(prevKey)\n    }\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThat means that usually we store in localStorage a value. But this value is in an object, and that object has a key. So for now it\u0026#x27;s \u0026#x27;count\u0026#x27;. But if it will be \u0026#x27;sum\u0026#x27;, and we don\u0026#x27;t remove the initial key, we\u0026#x27;ll have two objects in localStorage. So if the new key and the old one, which is stored in the useRef var, is different, we will remove the obect in localStorage with the old key.\u003c/p\u003e\u003ch2 id=\"3---lifting-and-colocating-state\"\u003e\u003ca href=\"#3---lifting-and-colocating-state\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003e3 - Lifting and Colocating state\u003c/h2\u003e\u003cp\u003eLifting state is when you have state managed inside a component but a parent component needs it to render it or display it somewhere else.\nSo when it\u0026#x27;s needed to lifting state, we take that state and find the least common parent between the two components. So the state is lifted from a lower branch of the family -or the tree- to a higher one.\u003c/p\u003e\u003cp\u003eColocating state, instead, is to place the state management the furthest down the tree as possible where not shared by a parent component. A state correctly colocated helps React to not having to render the whole application for just, for example, an input change.\nIf a state is used only by a component up the tree, it\u0026#x27;s probably possible to refactor it colocating the state in the sibling component that is managing it.\u003c/p\u003e\u003cpre\u003e\u003ccode\u003e  const [name, setName] = React.useState(\u0026#x27;\u0026#x27;)\n  const [animal, setAnimal] = React.useState(\u0026#x27;\u0026#x27;)\n  return (\n      \u0026lt;Name name={name} onNameChange={event =\u0026gt; setName(event.currentTarget.value)} /\u0026gt;\n      \u0026lt;FavoriteAnimal animal={animal} onAnimalChange={event =\u0026gt; setAnimal(event.currentTarget.value)} /\u0026gt;\n      \u0026lt;Display animal={animal} /\u0026gt;\n  )\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eIn the above case, for example, the animal state was lifted to the parent component as it\u0026#x27;s used by the Display component as well. But the name state is not used, so it can be colocated to Name component only. This will result like this:\u003c/p\u003e\u003cpre\u003e\u003ccode\u003efunction Name() {\n  const [name, setName] = React.useState(\u0026#x27;\u0026#x27;)\n\n  return (\n    \u0026lt;div\u0026gt;\n      \u0026lt;label htmlFor=\u0026quot;name\u0026quot;\u0026gt;Name: \u0026lt;/label\u0026gt;\n      \u0026lt;input id=\u0026quot;name\u0026quot; value={name} onChange={event =\u0026gt; setName(event.currentTarget.value)} /\u0026gt;\n    \u0026lt;/div\u0026gt;\n  )\n}\n\nconst [animal, setAnimal] = React.useState(\u0026#x27;\u0026#x27;)\n  return (\n    \u0026lt;form\u0026gt;\n      \u0026lt;Name /\u0026gt;\n      \u0026lt;FavoriteAnimal animal={animal} onAnimalChange={event =\u0026gt; setAnimal(event.currentTarget.value)} /\u0026gt;\n      \u0026lt;Display animal={animal} /\u0026gt;\n  )\n\u003c/code\u003e\u003c/pre\u003e","scope":{}},"frontMatter":{"wordCount":1521,"readingTime":{"text":"8 min read","minutes":7.595,"time":455700,"words":1519},"slug":"learning-on-epic-react-hooks","fileName":"learning-on-epic-react-hooks.mdx","title":"Epic React. Hooks. What I'm learning.","date":"2020-11-06","template":"post","draft":true,"tags":["react","web development","epic react"],"summary":"A guide of what I'm learning on the Epic React workshopds by Kent Dodds. This is the second one: hooks"}},"prev":{"title":"Useful GIT commands","date":"2021-01-26","tags":["git","web development"],"draft":false,"summary":"Useful commands to use in git in everyday working life","slug":"useful-git-commands"},"next":null},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"learning-on-epic-react-hooks"},"buildId":"NPdedC3vkr7Sk_pvxOE7Z","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-3cb8f7ab5d3930a1a759.js"></script><script src="/_next/static/chunks/main-f22e9874a1e2c26541ea.js" async=""></script><script src="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" async=""></script><script src="/_next/static/chunks/commons.c8e7d1406e41c62958d6.js" async=""></script><script src="/_next/static/chunks/bbd776c9508c221b4dea2d947302e2a4c5be009b.9fbf4a83f1e2236cbcd2.js" async=""></script><script src="/_next/static/chunks/5e22f815a215592c6a5f19c779112441096880a5.c88594719f2de2d20b63.js" async=""></script><script src="/_next/static/chunks/c9787b2e67d04485ea556b79e503c7f6cc1ff4d5.63394ce1ab43dabfc143.js" async=""></script><script src="/_next/static/chunks/pages/_app-b15f4062896a44e99538.js" async=""></script><script src="/_next/static/chunks/52916a2fbede746e315910e61cf72e23ae28baf9.6c4b1c8ba3f2908378c4.js" async=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-da4ab3a84120f7875cdd.js" async=""></script><script src="/_next/static/NPdedC3vkr7Sk_pvxOE7Z/_buildManifest.js" async=""></script><script src="/_next/static/NPdedC3vkr7Sk_pvxOE7Z/_ssgManifest.js" async=""></script></body></html>